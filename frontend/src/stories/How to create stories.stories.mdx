import { Meta } from '@storybook/addon-docs';

<Meta title=" How to create stories?" />

# How to create stories?

There are three types of stories:

- Markdown stories
- Scene stories
- Component stories

Choose the type most suited for your case.

## Markdown stories

Documents, such as the one you're reading, go in `frontend/src/stories/*.stories.mdx`.

Tip: you may want to add a space in front of the title for the doc to be ordered before other components in the sidebar.

```md
<!-- frontend/src/stories/New Page.stories.mdx -->
import { Meta } from '@storybook/addon-docs'

<Meta title=" New Page" />

# Page Title

Write your content here...
```


## Scene stories

In the same folder as your component, create a file like `Dashboard.stories.tsx`. If you need a lot of `.json`
files for mocked data, create a `__mocks__` subdirectory for those files, just like you would with `jest`.

```tsx
// frontend/src/scenes/dashboard/Dashboard.stories.tsx
import React, { useEffect } from 'react'
import { Meta } from '@storybook/react'
import { mswDecorator, useStorybookMocks } from '~/mocks/browser'
import { App } from 'scenes/App'
import { router } from 'kea-router'
import { urls } from 'scenes/urls'

export default {
    title: 'Scenes/Dashboard',
    decorators: [
        // mocks used by all stories in this file
        mswDecorator({
            get: {
                '/api/projects/1/dashboards/': require('./__mocks__/dashboards.json'),
                '/api/projects/1/dashboards/1/': require('./__mocks__/dashboard1.json'),
                '/api/projects/1/dashboards/1/collaborators/': [],
            },
        }),
    ],
    // NB! These `parameters` only apply for Scene stories.
    parameters: { layout: 'fullscreen', options: { showPanel: false }, viewMode: 'canvas' }, // scene mode
} as Meta

export function Dashboard (): JSX.Element {
    // mocks used only in this story
    useStorybookMocks({
        get: { '/api/projects/dashboard/2/': { success: true } },
    })
    useEffect(() => {
        // change the URL
        router.actions.push(urls.dashboard(1))
        // call various other actions to set the initial state
        dashboardModel.actions.doSomething()
    }, [])
    return <App />
}
```

### ProTipâ„¢: Copy and paste

You can see the source for all scenes directly in storybook. Open the scene in question and press the key "a". Then select "story".
Alternatively, click "..." next to the storybook header -> "show addons" -> "story".

![2022-03-17 08 56 56](https://user-images.githubusercontent.com/53387/158762995-7aa4c77f-64a8-42b0-b9d2-a2c0208b2a06.gif)

## Component stories

There are a few differences between component and scene stories:

- Pass a `component` to the default export, for Storybook to create a table with the component's props.
- Remove the custom `parameters` object that is in use in scene stories (that defaults the scene to open in "canvas" mode).
- Add any changes to arguments in [`argTypes`](https://storybook.js.org/docs/react/api/argtypes)

```tsx
// frontend/src/lib/components/LemonSwitch/LemonSwitch.stories.tsx
import React from 'react'
import { ComponentMeta } from '@storybook/react'

import { LemonSwitch, LemonSwitchProps } from './LemonSwitch'

export default {
    title: 'Components/Lemon Switch',
    component: LemonSwitch,
    argTypes: {
        loading: {
            control: {
                type: 'boolean',
            },
        },
        label: {
            name: 'label',
            type: { name: 'string', required: false },
            defaultValue: 'Hello',
            description: 'demo description',
            table: {
                type: { summary: 'string' },
                defaultValue: { summary: 'Hello' },
            },
            control: {
                type: 'text'
            },
        },
    },
} as ComponentMeta<typeof LemonTable>

export function LemonSwitch_(props: LemonSwitchProps): JSX.Element {
    const [isChecked, setIsChecked] = useState(false)

    return (
        <LemonSwitch
            {...props}
            checked={props.checked !== undefined ? props.checked : isChecked}
            onChange={setIsChecked}
        />
    )
}
```
