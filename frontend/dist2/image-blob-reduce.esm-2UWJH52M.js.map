{
  "version": 3,
  "sources": ["../../node_modules/.pnpm/image-blob-reduce@4.1.0/node_modules/image-blob-reduce/dist/image-blob-reduce.esm.mjs"],
  "sourcesContent": ["\n/*! image-blob-reduce 4.1.0 https://github.com/nodeca/image-blob-reduce @license MIT */\nfunction commonjsRequire (path) {\n\tthrow new Error('Could not dynamically require \"' + path + '\". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');\n}\n\nvar utils$1 = {};\n\nutils$1.assign = function assign(to) {\n  var from;\n\n  for (var s = 1; s < arguments.length; s++) {\n    from = Object(arguments[s]);\n\n    for (var key in from) {\n      if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n    }\n  }\n\n  return to;\n};\n\n\nfunction pick(from, props) {\n  var to = {};\n\n  props.forEach(function (key) {\n    if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n  });\n\n  return to;\n}\n\n\nfunction pick_pica_resize_options(from) {\n  return pick(from, [\n    'alpha',\n    'unsharpAmount',\n    'unsharpRadius',\n    'unsharpThreshold',\n    'cancelToken'\n  ]);\n}\n\n\nutils$1.pick = pick;\nutils$1.pick_pica_resize_options = pick_pica_resize_options;\n\nvar pica$1 = {exports: {}};\n\n/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/\n\n(function (module, exports) {\n(function(f){{module.exports=f();}})(function(){return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof commonjsRequire&&commonjsRequire;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t);}return n[i].exports}for(var u=\"function\"==typeof commonjsRequire&&commonjsRequire,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(_dereq_,module,exports){\n\nvar Multimath = _dereq_('multimath');\n\nvar mm_unsharp_mask = _dereq_('./mm_unsharp_mask');\n\nvar mm_resize = _dereq_('./mm_resize');\n\nfunction MathLib(requested_features) {\n  var __requested_features = requested_features || [];\n\n  var features = {\n    js: __requested_features.indexOf('js') >= 0,\n    wasm: __requested_features.indexOf('wasm') >= 0\n  };\n  Multimath.call(this, features);\n  this.features = {\n    js: features.js,\n    wasm: features.wasm && this.has_wasm()\n  };\n  this.use(mm_unsharp_mask);\n  this.use(mm_resize);\n}\n\nMathLib.prototype = Object.create(Multimath.prototype);\nMathLib.prototype.constructor = MathLib;\n\nMathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n  var result = this.resize(options, cache);\n\n  if (options.unsharpAmount) {\n    this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n  }\n\n  return result;\n};\n\nmodule.exports = MathLib;\n\n},{\"./mm_resize\":4,\"./mm_unsharp_mask\":9,\"multimath\":19}],2:[function(_dereq_,module,exports){\n//var FIXED_FRAC_BITS = 14;\n\nfunction clampTo8(i) {\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\nfunction clampNegative(i) {\n  return i >= 0 ? i : 0;\n} // Convolve image data in horizontal direction. Can be used for:\n//\n// 1. bitmap with premultiplied alpha\n// 2. bitmap without alpha (all values 255)\n//\n// Notes:\n//\n// - output is transposed\n// - output resolution is ~15 bits per channel(for better precision).\n//\n\n\nfunction convolveHor(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHor()`\n//\n\n\nfunction convolveVert(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Sync with premultiplied version for exact result match\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Bring this value back in range + round result.\n      //\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14);\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Premultiply & convolve image data in horizontal direction. Can be used for:\n//\n// - Any bitmap data, extracted with `.getImageData()` method (with\n//   non-premultiplied alpha)\n//\n// For images without alpha channel this method is slower than `convolveHor()`\n//\n\n\nfunction convolveHorWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a, alpha;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        alpha = src[srcPtr + 3];\n        a = a + filterVal * alpha | 0;\n        b = b + filterVal * src[srcPtr + 2] * alpha | 0;\n        g = g + filterVal * src[srcPtr + 1] * alpha | 0;\n        r = r + filterVal * src[srcPtr] * alpha | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Premultiply is (* alpha / 255).\n      // Postpone division for better performance\n\n\n      b = b / 255 | 0;\n      g = g / 255 | 0;\n      r = r / 255 | 0; // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHorWithPre()`\n//\n\n\nfunction convolveVertWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Downscale to leave room for un-premultiply\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Un-premultiply\n\n      a = clampTo8(a + (1 << 13) >> 14);\n\n      if (a > 0) {\n        r = r * 255 / a | 0;\n        g = g * 255 / a | 0;\n        b = b * 255 / a | 0;\n      } // Bring this value back in range + round result.\n      // Shift value = FIXED_FRAC_BITS + 7\n      //\n\n\n      dest[destOffset + 3] = a;\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\nmodule.exports = {\n  convolveHor: convolveHor,\n  convolveVert: convolveVert,\n  convolveHorWithPre: convolveHorWithPre,\n  convolveVertWithPre: convolveVertWithPre\n};\n\n},{}],3:[function(_dereq_,module,exports){\n/* eslint-disable max-len */\n\nmodule.exports = 'AGFzbQEAAAAADAZkeWxpbmsAAAAAAAEYA2AGf39/f39/AGAAAGAIf39/f39/f38AAg8BA2VudgZtZW1vcnkCAAADBwYBAAAAAAIGBgF/AEEACweUAQgRX193YXNtX2NhbGxfY3RvcnMAAAtjb252b2x2ZUhvcgABDGNvbnZvbHZlVmVydAACEmNvbnZvbHZlSG9yV2l0aFByZQADE2NvbnZvbHZlVmVydFdpdGhQcmUABApjb252b2x2ZUhWAAUMX19kc29faGFuZGxlAwAYX193YXNtX2FwcGx5X2RhdGFfcmVsb2NzAAAKyA4GAwABC4wDARB/AkAgA0UNACAERQ0AIANBAnQhFQNAQQAhE0EAIQsDQCALQQJqIQcCfyALQQF0IAVqIgYuAQIiC0UEQEEAIQhBACEGQQAhCUEAIQogBwwBCyASIAYuAQBqIQhBACEJQQAhCiALIRRBACEOIAchBkEAIQ8DQCAFIAZBAXRqLgEAIhAgACAIQQJ0aigCACIRQRh2bCAPaiEPIBFB/wFxIBBsIAlqIQkgEUEQdkH/AXEgEGwgDmohDiARQQh2Qf8BcSAQbCAKaiEKIAhBAWohCCAGQQFqIQYgFEEBayIUDQALIAlBB3UhCCAKQQd1IQYgDkEHdSEJIA9BB3UhCiAHIAtqCyELIAEgDEEBdCIHaiAIQQAgCEEAShs7AQAgASAHQQJyaiAGQQAgBkEAShs7AQAgASAHQQRyaiAJQQAgCUEAShs7AQAgASAHQQZyaiAKQQAgCkEAShs7AQAgDCAVaiEMIBNBAWoiEyAERw0ACyANQQFqIg0gAmwhEiANQQJ0IQwgAyANRw0ACwsL2gMBD38CQCADRQ0AIARFDQAgAkECdCEUA0AgCyEMQQAhE0EAIQIDQCACQQJqIQYCfyACQQF0IAVqIgcuAQIiAkUEQEEAIQhBACEHQQAhCkEAIQkgBgwBCyAHLgEAQQJ0IBJqIQhBACEJIAIhCkEAIQ0gBiEHQQAhDkEAIQ8DQCAFIAdBAXRqLgEAIhAgACAIQQF0IhFqLwEAbCAJaiEJIAAgEUEGcmovAQAgEGwgDmohDiAAIBFBBHJqLwEAIBBsIA9qIQ8gACARQQJyai8BACAQbCANaiENIAhBBGohCCAHQQFqIQcgCkEBayIKDQALIAlBB3UhCCANQQd1IQcgDkEHdSEKIA9BB3UhCSACIAZqCyECIAEgDEECdGogB0GAQGtBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobQQh0QYD+A3EgCUGAQGtBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobQRB0QYCA/AdxIApBgEBrQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EYdHJyIAhBgEBrQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG3I2AgAgAyAMaiEMIBNBAWoiEyAERw0ACyAUIAtBAWoiC2whEiADIAtHDQALCwuSAwEQfwJAIANFDQAgBEUNACADQQJ0IRUDQEEAIRNBACEGA0AgBkECaiEIAn8gBkEBdCAFaiIGLgECIgdFBEBBACEJQQAhDEEAIQ1BACEOIAgMAQsgEiAGLgEAaiEJQQAhDkEAIQ1BACEMIAchFEEAIQ8gCCEGA0AgBSAGQQF0ai4BACAAIAlBAnRqKAIAIhBBGHZsIhEgD2ohDyARIBBBEHZB/wFxbCAMaiEMIBEgEEEIdkH/AXFsIA1qIQ0gESAQQf8BcWwgDmohDiAJQQFqIQkgBkEBaiEGIBRBAWsiFA0ACyAPQQd1IQkgByAIagshBiABIApBAXQiCGogDkH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEECcmogDUH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEEEcmogDEH/AW1BB3UiB0EAIAdBAEobOwEAIAEgCEEGcmogCUEAIAlBAEobOwEAIAogFWohCiATQQFqIhMgBEcNAAsgC0EBaiILIAJsIRIgC0ECdCEKIAMgC0cNAAsLC4IEAQ9/AkAgA0UNACAERQ0AIAJBAnQhFANAIAshDEEAIRJBACEHA0AgB0ECaiEKAn8gB0EBdCAFaiICLgECIhNFBEBBACEIQQAhCUEAIQYgCiEHQQAMAQsgAi4BAEECdCARaiEJQQAhByATIQJBACENIAohBkEAIQ5BACEPA0AgBSAGQQF0ai4BACIIIAAgCUEBdCIQai8BAGwgB2ohByAAIBBBBnJqLwEAIAhsIA5qIQ4gACAQQQRyai8BACAIbCAPaiEPIAAgEEECcmovAQAgCGwgDWohDSAJQQRqIQkgBkEBaiEGIAJBAWsiAg0ACyAHQQd1IQggDUEHdSEJIA9BB3UhBiAKIBNqIQcgDkEHdQtBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKGyIKQf8BcQRAIAlB/wFsIAJtIQkgCEH/AWwgAm0hCCAGQf8BbCACbSEGCyABIAxBAnRqIAlBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKG0EIdEGA/gNxIAZBgEBrQQ51IgJB/wEgAkH/AUgbIgJBACACQQBKG0EQdEGAgPwHcSAKQRh0ciAIQYBAa0EOdSICQf8BIAJB/wFIGyICQQAgAkEAShtycjYCACADIAxqIQwgEkEBaiISIARHDQALIBQgC0EBaiILbCERIAMgC0cNAAsLC0AAIAcEQEEAIAIgAyAEIAUgABADIAJBACAEIAUgBiABEAQPC0EAIAIgAyAEIAUgABABIAJBACAEIAUgBiABEAIL';\n\n},{}],4:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name: 'resize',\n  fn: _dereq_('./resize'),\n  wasm_fn: _dereq_('./resize_wasm'),\n  wasm_src: _dereq_('./convolve_wasm_base64')\n};\n\n},{\"./convolve_wasm_base64\":3,\"./resize\":5,\"./resize_wasm\":8}],5:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nvar _require = _dereq_('./convolve'),\n    convolveHor = _require.convolveHor,\n    convolveVert = _require.convolveVert,\n    convolveHorWithPre = _require.convolveHorWithPre,\n    convolveVertWithPre = _require.convolveVertWithPre;\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nmodule.exports = function resize(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0;\n  var offsetY = options.offsetY || 0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY);\n  var tmp = new Uint16Array(destW * srcH * 4); // Autodetect if alpha channel exists, and use appropriate method\n\n  if (hasAlpha(src, srcW, srcH)) {\n    convolveHorWithPre(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVertWithPre(tmp, dest, srcH, destW, destH, filtersY);\n  } else {\n    convolveHor(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVert(tmp, dest, srcH, destW, destH, filtersY);\n    resetAlpha(dest, destW, destH);\n  }\n\n  return dest;\n};\n\n},{\"./convolve\":2,\"./resize_filter_gen\":6}],6:[function(_dereq_,module,exports){\n\nvar FILTER_INFO = _dereq_('./resize_filter_info'); // Precision of fixed FP values\n\n\nvar FIXED_FRAC_BITS = 14;\n\nfunction toFixedPoint(num) {\n  return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n}\n\nmodule.exports = function resizeFilterGen(filter, srcSize, destSize, scale, offset) {\n  var filterFunction = FILTER_INFO.filter[filter].fn;\n  var scaleInverted = 1.0 / scale;\n  var scaleClamped = Math.min(1.0, scale); // For upscale\n  // Filter window (averaging interval), scaled to src image\n\n  var srcWindow = FILTER_INFO.filter[filter].win / scaleClamped;\n  var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n  var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n  var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n  var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n  var packedFilterPtr = 0;\n  var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n\n  for (destPixel = 0; destPixel < destSize; destPixel++) {\n    // Scaling should be done relative to central pixel point\n    srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n    srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n    srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n    filterElementSize = srcLast - srcFirst + 1;\n    floatFilter = new Float32Array(filterElementSize);\n    fxpFilter = new Int16Array(filterElementSize);\n    total = 0.0; // Fill filter values for calculated range\n\n    for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n      floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n      total += floatVal;\n      floatFilter[idx] = floatVal;\n    } // Normalize filter, convert to fixed point and accumulate conversion error\n\n\n    filterTotal = 0;\n\n    for (idx = 0; idx < floatFilter.length; idx++) {\n      filterVal = floatFilter[idx] / total;\n      filterTotal += filterVal;\n      fxpFilter[idx] = toFixedPoint(filterVal);\n    } // Compensate normalization error, to minimize brightness drift\n\n\n    fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n    // Now pack filter to useable form\n    //\n    // 1. Trim heading and tailing zero values, and compensate shitf/length\n    // 2. Put all to single array in this format:\n    //\n    //    [ pos shift, data length, value1, value2, value3, ... ]\n    //\n\n    leftNotEmpty = 0;\n\n    while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n      leftNotEmpty++;\n    }\n\n    if (leftNotEmpty < fxpFilter.length) {\n      rightNotEmpty = fxpFilter.length - 1;\n\n      while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n        rightNotEmpty--;\n      }\n\n      filterShift = srcFirst + leftNotEmpty;\n      filterSize = rightNotEmpty - leftNotEmpty + 1;\n      packedFilter[packedFilterPtr++] = filterShift; // shift\n\n      packedFilter[packedFilterPtr++] = filterSize; // size\n\n      if (!slowCopy) {\n        packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n        packedFilterPtr += filterSize;\n      } else {\n        // fallback for old IE < 11, without subarray/set methods\n        for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n          packedFilter[packedFilterPtr++] = fxpFilter[idx];\n        }\n      }\n    } else {\n      // zero data, write header only\n      packedFilter[packedFilterPtr++] = 0; // shift\n\n      packedFilter[packedFilterPtr++] = 0; // size\n    }\n  }\n\n  return packedFilter;\n};\n\n},{\"./resize_filter_info\":7}],7:[function(_dereq_,module,exports){\n\nvar filter = {\n  // Nearest neibor\n  box: {\n    win: 0.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n      return x < 0.5 ? 1.0 : 0.0;\n    }\n  },\n  // // Hamming\n  hamming: {\n    win: 1.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 1.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n    }\n  },\n  // Lanczos, win = 2\n  lanczos2: {\n    win: 2.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n    }\n  },\n  // Lanczos, win = 3\n  lanczos3: {\n    win: 3.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 3.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n    }\n  },\n  // Magic Kernel Sharp 2013, win = 2.5\n  // http://johncostella.com/magic/\n  mks2013: {\n    win: 2.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.5) {\n        return 0.0;\n      }\n\n      if (x >= 1.5) {\n        return -0.125 * (x - 2.5) * (x - 2.5);\n      }\n\n      if (x >= 0.5) {\n        return 0.25 * (4 * x * x - 11 * x + 7);\n      }\n\n      return 1.0625 - 1.75 * x * x;\n    }\n  }\n};\nmodule.exports = {\n  filter: filter,\n  // Legacy mapping\n  f2q: {\n    box: 0,\n    hamming: 1,\n    lanczos2: 2,\n    lanczos3: 3\n  },\n  q2f: ['box', 'hamming', 'lanczos2', 'lanczos3']\n};\n\n},{}],8:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nfunction asUint8Array(src) {\n  return new Uint8Array(src.buffer, 0, src.byteLength);\n}\n\nvar IS_LE = true; // should not crash everything on module load in old browsers\n\ntry {\n  IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n} catch (__) {}\n\nfunction copyInt16asLE(src, target, target_offset) {\n  if (IS_LE) {\n    target.set(asUint8Array(src), target_offset);\n    return;\n  }\n\n  for (var ptr = target_offset, i = 0; i < src.length; i++) {\n    var data = src[i];\n    target[ptr++] = data & 0xFF;\n    target[ptr++] = data >> 8 & 0xFF;\n  }\n}\n\nmodule.exports = function resize_wasm(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0.0;\n  var offsetY = options.offsetY || 0.0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY); // destination is 0 too.\n\n  var src_offset = 0;\n  var src_size = Math.max(src.byteLength, dest.byteLength); // buffer between convolve passes\n\n  var tmp_offset = this.__align(src_offset + src_size);\n\n  var tmp_size = srcH * destW * 4 * 2; // 2 bytes per channel\n\n  var filtersX_offset = this.__align(tmp_offset + tmp_size);\n\n  var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n\n  var alloc_bytes = filtersY_offset + filtersY.byteLength;\n\n  var instance = this.__instance('resize', alloc_bytes); //\n  // Fill memory block with data to process\n  //\n\n\n  var mem = new Uint8Array(this.__memory.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n\n  var src32 = new Uint32Array(src.buffer);\n  mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n  // speed difference is not significant vs direct .set()\n\n  copyInt16asLE(filtersX, mem, filtersX_offset);\n  copyInt16asLE(filtersY, mem, filtersY_offset); // Now call webassembly method\n  // emsdk does method names with '_'\n\n  var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n\n  if (hasAlpha(src, srcW, srcH)) {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 1);\n  } else {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 0);\n    resetAlpha(dest, destW, destH);\n  } //\n  // Copy data back to typed array\n  //\n  // 32-bit copy is much faster in chrome\n\n\n  var dest32 = new Uint32Array(dest.buffer);\n  dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW));\n  return dest;\n};\n\n},{\"./resize_filter_gen\":6}],9:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name: 'unsharp_mask',\n  fn: _dereq_('./unsharp_mask'),\n  wasm_fn: _dereq_('./unsharp_mask_wasm'),\n  wasm_src: _dereq_('./unsharp_mask_wasm_base64')\n};\n\n},{\"./unsharp_mask\":10,\"./unsharp_mask_wasm\":11,\"./unsharp_mask_wasm_base64\":12}],10:[function(_dereq_,module,exports){\n\nvar glur_mono16 = _dereq_('glur/mono16');\n\nfunction hsv_v16(img, width, height) {\n  var size = width * height;\n  var out = new Uint16Array(size);\n  var r, g, b, max;\n\n  for (var i = 0; i < size; i++) {\n    r = img[4 * i];\n    g = img[4 * i + 1];\n    b = img[4 * i + 2];\n    max = r >= g && r >= b ? r : g >= b && g >= r ? g : b;\n    out[i] = max << 8;\n  }\n\n  return out;\n}\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  var v1, v2, vmul;\n  var diff, iTimes4;\n\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var brightness = hsv_v16(img, width, height);\n  var blured = new Uint16Array(brightness); // copy, because blur modify src\n\n  glur_mono16(blured, width, height, radius);\n  var amountFp = amount / 100 * 0x1000 + 0.5 | 0;\n  var thresholdFp = threshold << 8;\n  var size = width * height;\n  /* eslint-disable indent */\n\n  for (var i = 0; i < size; i++) {\n    v1 = brightness[i];\n    diff = v1 - blured[i];\n\n    if (Math.abs(diff) >= thresholdFp) {\n      // add unsharp mask to the brightness channel\n      v2 = v1 + (amountFp * diff + 0x800 >> 12); // Both v1 and v2 are within [0.0 .. 255.0] (0000-FF00) range, never going into\n      // [255.003 .. 255.996] (FF01-FFFF). This allows to round this value as (x+.5)|0\n      // later without overflowing.\n\n      v2 = v2 > 0xff00 ? 0xff00 : v2;\n      v2 = v2 < 0x0000 ? 0x0000 : v2; // Avoid division by 0. V=0 means rgb(0,0,0), unsharp with unsharpAmount>0 cannot\n      // change this value (because diff between colors gets inflated), so no need to verify correctness.\n\n      v1 = v1 !== 0 ? v1 : 1; // Multiplying V in HSV model by a constant is equivalent to multiplying each component\n      // in RGB by the same constant (same for HSL), see also:\n      // https://beesbuzz.biz/code/16-hsv-color-transforms\n\n      vmul = (v2 << 12) / v1 | 0; // Result will be in [0..255] range because:\n      //  - all numbers are positive\n      //  - r,g,b <= (v1/256)\n      //  - r,g,b,(v1/256),(v2/256) <= 255\n      // So highest this number can get is X*255/X+0.5=255.5 which is < 256 and rounds down.\n\n      iTimes4 = i * 4;\n      img[iTimes4] = img[iTimes4] * vmul + 0x800 >> 12; // R\n\n      img[iTimes4 + 1] = img[iTimes4 + 1] * vmul + 0x800 >> 12; // G\n\n      img[iTimes4 + 2] = img[iTimes4 + 2] * vmul + 0x800 >> 12; // B\n    }\n  }\n};\n\n},{\"glur/mono16\":18}],11:[function(_dereq_,module,exports){\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var pixels = width * height;\n  var img_bytes_cnt = pixels * 4;\n  var hsv_bytes_cnt = pixels * 2;\n  var blur_bytes_cnt = pixels * 2;\n  var blur_line_byte_cnt = Math.max(width, height) * 4; // float32 array\n\n  var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n  var img_offset = 0;\n  var hsv_offset = img_bytes_cnt;\n  var blur_offset = hsv_offset + hsv_bytes_cnt;\n  var blur_tmp_offset = blur_offset + blur_bytes_cnt;\n  var blur_line_offset = blur_tmp_offset + blur_bytes_cnt;\n  var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n\n  var instance = this.__instance('unsharp_mask', img_bytes_cnt + hsv_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt, {\n    exp: Math.exp\n  }); // 32-bit copy is much faster in chrome\n\n\n  var img32 = new Uint32Array(img.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n  mem32.set(img32); // HSL\n\n  var fn = instance.exports.hsv_v16 || instance.exports._hsv_v16;\n  fn(img_offset, hsv_offset, width, height); // BLUR\n\n  fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n  fn(hsv_offset, blur_offset, blur_tmp_offset, blur_line_offset, blur_coeffs_offset, width, height, radius); // UNSHARP\n\n  fn = instance.exports.unsharp || instance.exports._unsharp;\n  fn(img_offset, img_offset, hsv_offset, blur_offset, width, height, amount, threshold); // 32-bit copy is much faster in chrome\n\n  img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n};\n\n},{}],12:[function(_dereq_,module,exports){\n/* eslint-disable max-len */\n\nmodule.exports = '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';\n\n},{}],13:[function(_dereq_,module,exports){\n\nvar GC_INTERVAL = 100;\n\nfunction Pool(create, idle) {\n  this.create = create;\n  this.available = [];\n  this.acquired = {};\n  this.lastId = 1;\n  this.timeoutId = 0;\n  this.idle = idle || 2000;\n}\n\nPool.prototype.acquire = function () {\n  var _this = this;\n\n  var resource;\n\n  if (this.available.length !== 0) {\n    resource = this.available.pop();\n  } else {\n    resource = this.create();\n    resource.id = this.lastId++;\n\n    resource.release = function () {\n      return _this.release(resource);\n    };\n  }\n\n  this.acquired[resource.id] = resource;\n  return resource;\n};\n\nPool.prototype.release = function (resource) {\n  var _this2 = this;\n\n  delete this.acquired[resource.id];\n  resource.lastUsed = Date.now();\n  this.available.push(resource);\n\n  if (this.timeoutId === 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this2.gc();\n    }, GC_INTERVAL);\n  }\n};\n\nPool.prototype.gc = function () {\n  var _this3 = this;\n\n  var now = Date.now();\n  this.available = this.available.filter(function (resource) {\n    if (now - resource.lastUsed > _this3.idle) {\n      resource.destroy();\n      return false;\n    }\n\n    return true;\n  });\n\n  if (this.available.length !== 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this3.gc();\n    }, GC_INTERVAL);\n  } else {\n    this.timeoutId = 0;\n  }\n};\n\nmodule.exports = Pool;\n\n},{}],14:[function(_dereq_,module,exports){\n// min size = 1 can consume large amount of memory\n\nvar MIN_INNER_TILE_SIZE = 2;\n\nmodule.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n  var scaleX = toWidth / fromWidth;\n  var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n  // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n\n  var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n  // it could only happen because of invalid options\n\n  if (minScale > 0.5) return [[toWidth, toHeight]];\n  var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n  // stageCount can be zero or be negative when enlarging the image\n\n  if (stageCount <= 1) return [[toWidth, toHeight]];\n  var result = [];\n\n  for (var i = 0; i < stageCount; i++) {\n    var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n    var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n    result.push([width, height]);\n  }\n\n  return result;\n};\n\n},{}],15:[function(_dereq_,module,exports){\n/*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */\n\nvar PIXEL_EPSILON = 1e-5;\n\nfunction pixelFloor(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.floor(x);\n}\n\nfunction pixelCeil(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.ceil(x);\n}\n\nmodule.exports = function createRegions(options) {\n  var scaleX = options.toWidth / options.width;\n  var scaleY = options.toHeight / options.height;\n  var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n  var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n\n  if (innerTileWidth < 1 || innerTileHeight < 1) {\n    throw new Error('Internal error in pica: target tile width/height is too small.');\n  }\n\n  var x, y;\n  var innerX, innerY, toTileWidth, toTileHeight;\n  var tiles = [];\n  var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n  // doesn in the browser\n\n  for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n    for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n      x = innerX - options.destTileBorder;\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n\n      if (x + toTileWidth >= options.toWidth) {\n        toTileWidth = options.toWidth - x;\n      }\n\n      y = innerY - options.destTileBorder;\n\n      if (y < 0) {\n        y = 0;\n      }\n\n      toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n\n      if (y + toTileHeight >= options.toHeight) {\n        toTileHeight = options.toHeight - y;\n      }\n\n      tile = {\n        toX: x,\n        toY: y,\n        toWidth: toTileWidth,\n        toHeight: toTileHeight,\n        toInnerX: innerX,\n        toInnerY: innerY,\n        toInnerWidth: innerTileWidth,\n        toInnerHeight: innerTileHeight,\n        offsetX: x / scaleX - pixelFloor(x / scaleX),\n        offsetY: y / scaleY - pixelFloor(y / scaleY),\n        scaleX: scaleX,\n        scaleY: scaleY,\n        x: pixelFloor(x / scaleX),\n        y: pixelFloor(y / scaleY),\n        width: pixelCeil(toTileWidth / scaleX),\n        height: pixelCeil(toTileHeight / scaleY)\n      };\n      tiles.push(tile);\n    }\n  }\n\n  return tiles;\n};\n\n},{}],16:[function(_dereq_,module,exports){\n\nfunction objClass(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nmodule.exports.isCanvas = function isCanvas(element) {\n  var cname = objClass(element);\n  return cname === '[object HTMLCanvasElement]'\n  /* browser */\n  || cname === '[object OffscreenCanvas]' || cname === '[object Canvas]'\n  /* node-canvas */\n  ;\n};\n\nmodule.exports.isImage = function isImage(element) {\n  return objClass(element) === '[object HTMLImageElement]';\n};\n\nmodule.exports.isImageBitmap = function isImageBitmap(element) {\n  return objClass(element) === '[object ImageBitmap]';\n};\n\nmodule.exports.limiter = function limiter(concurrency) {\n  var active = 0,\n      queue = [];\n\n  function roll() {\n    if (active < concurrency && queue.length) {\n      active++;\n      queue.shift()();\n    }\n  }\n\n  return function limit(fn) {\n    return new Promise(function (resolve, reject) {\n      queue.push(function () {\n        fn().then(function (result) {\n          resolve(result);\n          active--;\n          roll();\n        }, function (err) {\n          reject(err);\n          active--;\n          roll();\n        });\n      });\n      roll();\n    });\n  };\n};\n\nmodule.exports.cib_quality_name = function cib_quality_name(num) {\n  switch (num) {\n    case 0:\n      return 'pixelated';\n\n    case 1:\n      return 'low';\n\n    case 2:\n      return 'medium';\n  }\n\n  return 'high';\n};\n\nmodule.exports.cib_support = function cib_support(createCanvas) {\n  return Promise.resolve().then(function () {\n    if (typeof createImageBitmap === 'undefined') {\n      return false;\n    }\n\n    var c = createCanvas(100, 100);\n    return createImageBitmap(c, 0, 0, 100, 100, {\n      resizeWidth: 10,\n      resizeHeight: 10,\n      resizeQuality: 'high'\n    }).then(function (bitmap) {\n      var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n      // detection for basic ImageBitmap.\n      //\n      // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n      // old Crome 51 has ImageBitmap without .close(). Then this code\n      // will throw and return 'false' as expected.\n      //\n\n      bitmap.close();\n      c = null;\n      return status;\n    });\n  })[\"catch\"](function () {\n    return false;\n  });\n};\n\nmodule.exports.worker_offscreen_canvas_support = function worker_offscreen_canvas_support() {\n  return new Promise(function (resolve, reject) {\n    if (typeof OffscreenCanvas === 'undefined') {\n      // if OffscreenCanvas is present, we assume browser supports Worker and built-in Promise as well\n      resolve(false);\n      return;\n    }\n\n    function workerPayload(self) {\n      if (typeof createImageBitmap === 'undefined') {\n        self.postMessage(false);\n        return;\n      }\n\n      Promise.resolve().then(function () {\n        var canvas = new OffscreenCanvas(10, 10); // test that 2d context can be used in worker\n\n        var ctx = canvas.getContext('2d');\n        ctx.rect(0, 0, 1, 1); // test that cib can be used to return image bitmap from worker\n\n        return createImageBitmap(canvas, 0, 0, 1, 1);\n      }).then(function () {\n        return self.postMessage(true);\n      }, function () {\n        return self.postMessage(false);\n      });\n    }\n\n    var code = btoa(\"(\".concat(workerPayload.toString(), \")(self);\"));\n    var w = new Worker(\"data:text/javascript;base64,\".concat(code));\n\n    w.onmessage = function (ev) {\n      return resolve(ev.data);\n    };\n\n    w.onerror = reject;\n  }).then(function (result) {\n    return result;\n  }, function () {\n    return false;\n  });\n}; // Check if canvas.getContext('2d').getImageData can be used,\n// FireFox randomizes the output of that function in `privacy.resistFingerprinting` mode\n\n\nmodule.exports.can_use_canvas = function can_use_canvas(createCanvas) {\n  var usable = false;\n\n  try {\n    var canvas = createCanvas(2, 1);\n    var ctx = canvas.getContext('2d');\n    var d = ctx.createImageData(2, 1);\n    d.data[0] = 12;\n    d.data[1] = 23;\n    d.data[2] = 34;\n    d.data[3] = 255;\n    d.data[4] = 45;\n    d.data[5] = 56;\n    d.data[6] = 67;\n    d.data[7] = 255;\n    ctx.putImageData(d, 0, 0);\n    d = null;\n    d = ctx.getImageData(0, 0, 2, 1);\n\n    if (d.data[0] === 12 && d.data[1] === 23 && d.data[2] === 34 && d.data[3] === 255 && d.data[4] === 45 && d.data[5] === 56 && d.data[6] === 67 && d.data[7] === 255) {\n      usable = true;\n    }\n  } catch (err) {}\n\n  return usable;\n}; // Check if createImageBitmap(img, sx, sy, sw, sh) signature works correctly\n// with JPEG images oriented with Exif;\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n// TODO: remove after it's fixed in chrome for at least 2 releases\n\n\nmodule.exports.cib_can_use_region = function cib_can_use_region() {\n  return new Promise(function (resolve) {\n    if (typeof createImageBitmap === 'undefined') {\n      resolve(false);\n      return;\n    }\n\n    var image = new Image();\n    image.src = 'data:image/jpeg;base64,' + '/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAA' + 'AABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9' + 'sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRc' + 'ZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoa' + 'GhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRA' + 'f/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAA' + 'IQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAA' + 'AAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIB' + 'AT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAA' + 'AAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAA' + 'AAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQ' + 'QAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z';\n\n    image.onload = function () {\n      createImageBitmap(image, 0, 0, image.width, image.height).then(function (bitmap) {\n        if (bitmap.width === image.width && bitmap.height === image.height) {\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      }, function () {\n        return resolve(false);\n      });\n    };\n\n    image.onerror = function () {\n      return resolve(false);\n    };\n  });\n};\n\n},{}],17:[function(_dereq_,module,exports){\n\nmodule.exports = function () {\n  var MathLib = _dereq_('./mathlib');\n\n  var mathLib;\n  /* eslint-disable no-undef */\n\n  onmessage = function onmessage(ev) {\n    var tileOpts = ev.data.opts;\n\n    if (!tileOpts.src && tileOpts.srcBitmap) {\n      var canvas = new OffscreenCanvas(tileOpts.width, tileOpts.height);\n      var ctx = canvas.getContext('2d');\n      ctx.drawImage(tileOpts.srcBitmap, 0, 0);\n      tileOpts.src = ctx.getImageData(0, 0, tileOpts.width, tileOpts.height).data;\n      canvas.width = canvas.height = 0;\n      canvas = null;\n      tileOpts.srcBitmap.close();\n      tileOpts.srcBitmap = null; // Temporary force out data to typed array, because Chrome have artefacts\n      // https://github.com/nodeca/pica/issues/223\n      // returnBitmap = true;\n    }\n\n    if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n    // because polyfills are not propagated to webworker.\n\n    var data = mathLib.resizeAndUnsharp(tileOpts);\n\n    {\n      postMessage({\n        data: data\n      }, [data.buffer]);\n    }\n  };\n};\n\n},{\"./mathlib\":1}],18:[function(_dereq_,module,exports){\n// Calculate Gaussian blur of an image using IIR filter\n// The method is taken from Intel's white paper and code example attached to it:\n// https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n// -implementation-using-intel-advanced-vector-extensions\n\nvar a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n\nfunction gaussCoef(sigma) {\n  if (sigma < 0.5) {\n    sigma = 0.5;\n  }\n\n  var a = Math.exp(0.726 * 0.726) / sigma,\n      g1 = Math.exp(-a),\n      g2 = Math.exp(-2 * a),\n      k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n\n  a0 = k;\n  a1 = k * (a - 1) * g1;\n  a2 = k * (a + 1) * g1;\n  a3 = -k * g2;\n  b1 = 2 * g1;\n  b2 = -g2;\n  left_corner = (a0 + a1) / (1 - b1 - b2);\n  right_corner = (a2 + a3) / (1 - b1 - b2);\n\n  // Attempt to force type to FP32.\n  return new Float32Array([ a0, a1, a2, a3, b1, b2, left_corner, right_corner ]);\n}\n\nfunction convolveMono16(src, out, line, coeff, width, height) {\n  // takes src image and writes the blurred and transposed result into out\n\n  var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n  var src_index, out_index, line_index;\n  var i, j;\n  var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n\n  for (i = 0; i < height; i++) {\n    src_index = i * width;\n    out_index = i;\n    line_index = 0;\n\n    // left to right\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[6];\n    prev_out = prev_prev_out;\n\n    coeff_a0 = coeff[0];\n    coeff_a1 = coeff[1];\n    coeff_b1 = coeff[4];\n    coeff_b2 = coeff[5];\n\n    for (j = 0; j < width; j++) {\n      curr_src = src[src_index];\n\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n      prev_src = curr_src;\n\n      line[line_index] = prev_out;\n      line_index++;\n      src_index++;\n    }\n\n    src_index--;\n    line_index--;\n    out_index += height * (width - 1);\n\n    // right to left\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[7];\n    prev_out = prev_prev_out;\n    curr_src = prev_src;\n\n    coeff_a0 = coeff[2];\n    coeff_a1 = coeff[3];\n\n    for (j = width - 1; j >= 0; j--) {\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n\n      prev_src = curr_src;\n      curr_src = src[src_index];\n\n      out[out_index] = line[line_index] + prev_out;\n\n      src_index--;\n      line_index--;\n      out_index -= height;\n    }\n  }\n}\n\n\nfunction blurMono16(src, width, height, radius) {\n  // Quick exit on zero radius\n  if (!radius) { return; }\n\n  var out      = new Uint16Array(src.length),\n      tmp_line = new Float32Array(Math.max(width, height));\n\n  var coeff = gaussCoef(radius);\n\n  convolveMono16(src, out, tmp_line, coeff, width, height);\n  convolveMono16(out, src, tmp_line, coeff, height, width);\n}\n\nmodule.exports = blurMono16;\n\n},{}],19:[function(_dereq_,module,exports){\n\n\nvar assign         = _dereq_('object-assign');\nvar base64decode   = _dereq_('./lib/base64decode');\nvar hasWebAssembly = _dereq_('./lib/wa_detect');\n\n\nvar DEFAULT_OPTIONS = {\n  js: true,\n  wasm: true\n};\n\n\nfunction MultiMath(options) {\n  if (!(this instanceof MultiMath)) return new MultiMath(options);\n\n  var opts = assign({}, DEFAULT_OPTIONS, options || {});\n\n  this.options         = opts;\n\n  this.__cache         = {};\n\n  this.__init_promise  = null;\n  this.__modules       = opts.modules || {};\n  this.__memory        = null;\n  this.__wasm          = {};\n\n  this.__isLE = ((new Uint32Array((new Uint8Array([ 1, 0, 0, 0 ])).buffer))[0] === 1);\n\n  if (!this.options.js && !this.options.wasm) {\n    throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n  }\n}\n\n\nMultiMath.prototype.has_wasm = hasWebAssembly;\n\n\nMultiMath.prototype.use = function (module) {\n  this.__modules[module.name] = module;\n\n  // Pin the best possible implementation\n  if (this.options.wasm && this.has_wasm() && module.wasm_fn) {\n    this[module.name] = module.wasm_fn;\n  } else {\n    this[module.name] = module.fn;\n  }\n\n  return this;\n};\n\n\nMultiMath.prototype.init = function () {\n  if (this.__init_promise) return this.__init_promise;\n\n  if (!this.options.js && this.options.wasm && !this.has_wasm()) {\n    return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n  }\n\n  var self = this;\n\n  this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n    var module = self.__modules[name];\n\n    if (!self.options.wasm || !self.has_wasm() || !module.wasm_fn) return null;\n\n    // If already compiled - exit\n    if (self.__wasm[name]) return null;\n\n    // Compile wasm source\n    return WebAssembly.compile(self.__base64decode(module.wasm_src))\n      .then(function (m) { self.__wasm[name] = m; });\n  }))\n    .then(function () { return self; });\n\n  return this.__init_promise;\n};\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Methods below are for internal use from plugins\n\n\n// Simple decode base64 to typed array. Useful to load embedded webassembly\n// code. You probably don't need to call this method directly.\n//\nMultiMath.prototype.__base64decode = base64decode;\n\n\n// Increase current memory to include specified number of bytes. Do nothing if\n// size is already ok. You probably don't need to call this method directly,\n// because it will be invoked from `.__instance()`.\n//\nMultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n  if (!this.__memory) {\n    this.__memory = new WebAssembly.Memory({\n      initial: Math.ceil(bytes / (64 * 1024))\n    });\n    return this.__memory;\n  }\n\n  var mem_size = this.__memory.buffer.byteLength;\n\n  if (mem_size < bytes) {\n    this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n  }\n\n  return this.__memory;\n};\n\n\n// Returns instantinated webassembly item by name, with specified memory size\n// and environment.\n// - use cache if available\n// - do sync module init, if async init was not called earlier\n// - allocate memory if not enougth\n// - can export functions to webassembly via \"env_extra\",\n//   for example, { exp: Math.exp }\n//\nMultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n  if (memsize) this.__reallocate(memsize);\n\n  // If .init() was not called, do sync compile\n  if (!this.__wasm[name]) {\n    var module = this.__modules[name];\n    this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n  }\n\n  if (!this.__cache[name]) {\n    var env_base = {\n      memoryBase: 0,\n      memory: this.__memory,\n      tableBase: 0,\n      table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' })\n    };\n\n    this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n      env: assign(env_base, env_extra || {})\n    });\n  }\n\n  return this.__cache[name];\n};\n\n\n// Helper to calculate memory aligh for pointers. Webassembly does not require\n// this, but you may wish to experiment. Default base = 8;\n//\nMultiMath.prototype.__align = function align(number, base) {\n  base = base || 8;\n  var reminder = number % base;\n  return number + (reminder ? base - reminder : 0);\n};\n\n\nmodule.exports = MultiMath;\n\n},{\"./lib/base64decode\":20,\"./lib/wa_detect\":21,\"object-assign\":22}],20:[function(_dereq_,module,exports){\n\n\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n\nmodule.exports = function base64decode(str) {\n  var input = str.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max   = input.length;\n\n  var out = new Uint8Array((max * 3) >> 2);\n\n  // Collect by 6*4 bits (3 bytes)\n\n  var bits = 0;\n  var ptr  = 0;\n\n  for (var idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      out[ptr++] = (bits >> 16) & 0xFF;\n      out[ptr++] = (bits >> 8) & 0xFF;\n      out[ptr++] = bits & 0xFF;\n    }\n\n    bits = (bits << 6) | BASE64_MAP.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  var tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    out[ptr++] = (bits >> 16) & 0xFF;\n    out[ptr++] = (bits >> 8) & 0xFF;\n    out[ptr++] = bits & 0xFF;\n  } else if (tailbits === 18) {\n    out[ptr++] = (bits >> 10) & 0xFF;\n    out[ptr++] = (bits >> 2) & 0xFF;\n  } else if (tailbits === 12) {\n    out[ptr++] = (bits >> 4) & 0xFF;\n  }\n\n  return out;\n};\n\n},{}],21:[function(_dereq_,module,exports){\n\n\nvar wa;\n\n\nmodule.exports = function hasWebAssembly() {\n  // use cache if called before;\n  if (typeof wa !== 'undefined') return wa;\n\n  wa = false;\n\n  if (typeof WebAssembly === 'undefined') return wa;\n\n  // If WebAssenbly is disabled, code can throw on compile\n  try {\n    // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n    // Additional check that WA internals are correct\n\n    /* eslint-disable comma-spacing, max-len */\n    var bin      = new Uint8Array([ 0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11 ]);\n    var module   = new WebAssembly.Module(bin);\n    var instance = new WebAssembly.Instance(module, {});\n\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    if (instance.exports.test(4) !== 0) wa = true;\n\n    return wa;\n  } catch (__) {}\n\n  return wa;\n};\n\n},{}],22:[function(_dereq_,module,exports){\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],23:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],\"/index.js\":[function(_dereq_,module,exports){\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar assign = _dereq_('object-assign');\n\nvar webworkify = _dereq_('webworkify');\n\nvar MathLib = _dereq_('./lib/mathlib');\n\nvar Pool = _dereq_('./lib/pool');\n\nvar utils = _dereq_('./lib/utils');\n\nvar worker = _dereq_('./lib/worker');\n\nvar createStages = _dereq_('./lib/stepper');\n\nvar createRegions = _dereq_('./lib/tiler');\n\nvar filter_info = _dereq_('./lib/mm_resize/resize_filter_info'); // Deduplicate pools & limiters with the same configs\n// when user creates multiple pica instances.\n\n\nvar singletones = {};\nvar NEED_SAFARI_FIX = false;\n\ntry {\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n  }\n} catch (e) {}\n\nvar concurrency = 1;\n\nif (typeof navigator !== 'undefined') {\n  concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n}\n\nvar DEFAULT_PICA_OPTS = {\n  tile: 1024,\n  concurrency: concurrency,\n  features: ['js', 'wasm', 'ww'],\n  idle: 2000,\n  createCanvas: function createCanvas(width, height) {\n    var tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    return tmpCanvas;\n  }\n};\nvar DEFAULT_RESIZE_OPTS = {\n  filter: 'mks2013',\n  unsharpAmount: 0,\n  unsharpRadius: 0.0,\n  unsharpThreshold: 0\n};\nvar CAN_NEW_IMAGE_DATA = false;\nvar CAN_CREATE_IMAGE_BITMAP = false;\nvar CAN_USE_CANVAS_GET_IMAGE_DATA = false;\nvar CAN_USE_OFFSCREEN_CANVAS = false;\nvar CAN_USE_CIB_REGION_FOR_IMAGE = false;\n\nfunction workerFabric() {\n  return {\n    value: webworkify(worker),\n    destroy: function destroy() {\n      this.value.terminate();\n\n      if (typeof window !== 'undefined') {\n        var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n        if (url && url.revokeObjectURL && this.value.objectURL) {\n          url.revokeObjectURL(this.value.objectURL);\n        }\n      }\n    }\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n// API methods\n\n\nfunction Pica(options) {\n  if (!(this instanceof Pica)) return new Pica(options);\n  this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n  var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n  // multiple pica instances.\n\n  this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n  if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n\n  this.features = {\n    js: false,\n    // pure JS implementation, can be disabled for testing\n    wasm: false,\n    // webassembly implementation for heavy functions\n    cib: false,\n    // resize via createImageBitmap (only FF at this moment)\n    ww: false // webworkers\n\n  };\n  this.__workersPool = null; // Store requested features for webworkers\n\n  this.__requested_features = [];\n  this.__mathlib = null;\n}\n\nPica.prototype.init = function () {\n  var _this = this;\n\n  if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n\n  if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n    try {\n      /* eslint-disable no-new */\n      new ImageData(new Uint8ClampedArray(400), 10, 10);\n      CAN_NEW_IMAGE_DATA = true;\n    } catch (__) {}\n  } // ImageBitmap can be effective in 2 places:\n  //\n  // 1. Threaded jpeg unpack (basic)\n  // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n  //\n  // For basic use we also need ImageBitmap wo support .close() method,\n  // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n\n  if (typeof ImageBitmap !== 'undefined') {\n    if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n      CAN_CREATE_IMAGE_BITMAP = true;\n    } else {\n      this.debug('ImageBitmap does not support .close(), disabled');\n    }\n  }\n\n  var features = this.options.features.slice();\n\n  if (features.indexOf('all') >= 0) {\n    features = ['cib', 'wasm', 'js', 'ww'];\n  }\n\n  this.__requested_features = features;\n  this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n\n  if (features.indexOf('ww') >= 0) {\n    if (typeof window !== 'undefined' && 'Worker' in window) {\n      // IE <= 11 don't allow to create webworkers from string. We should check it.\n      // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n      try {\n        var wkr = _dereq_('webworkify')(function () {});\n\n        wkr.terminate();\n        this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n\n        var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n\n        if (singletones[wpool_key]) {\n          this.__workersPool = singletones[wpool_key];\n        } else {\n          this.__workersPool = new Pool(workerFabric, this.options.idle);\n          singletones[wpool_key] = this.__workersPool;\n        }\n      } catch (__) {}\n    }\n  }\n\n  var initMath = this.__mathlib.init().then(function (mathlib) {\n    // Copy detected features\n    assign(_this.features, mathlib.features);\n  });\n\n  var checkCibResize;\n\n  if (!CAN_CREATE_IMAGE_BITMAP) {\n    checkCibResize = Promise.resolve(false);\n  } else {\n    checkCibResize = utils.cib_support(this.options.createCanvas).then(function (status) {\n      if (_this.features.cib && features.indexOf('cib') < 0) {\n        _this.debug('createImageBitmap() resize supported, but disabled by config');\n\n        return;\n      }\n\n      if (features.indexOf('cib') >= 0) _this.features.cib = status;\n    });\n  }\n\n  CAN_USE_CANVAS_GET_IMAGE_DATA = utils.can_use_canvas(this.options.createCanvas);\n  var checkOffscreenCanvas;\n\n  if (CAN_CREATE_IMAGE_BITMAP && CAN_NEW_IMAGE_DATA && features.indexOf('ww') !== -1) {\n    checkOffscreenCanvas = utils.worker_offscreen_canvas_support();\n  } else {\n    checkOffscreenCanvas = Promise.resolve(false);\n  }\n\n  checkOffscreenCanvas = checkOffscreenCanvas.then(function (result) {\n    CAN_USE_OFFSCREEN_CANVAS = result;\n  }); // we use createImageBitmap to crop image data and pass it to workers,\n  // so need to check whether function works correctly;\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n\n  var checkCibRegion = utils.cib_can_use_region().then(function (result) {\n    CAN_USE_CIB_REGION_FOR_IMAGE = result;\n  }); // Init math lib. That's async because can load some\n\n  this.__initPromise = Promise.all([initMath, checkCibResize, checkOffscreenCanvas, checkCibRegion]).then(function () {\n    return _this;\n  });\n  return this.__initPromise;\n}; // Call resizer in webworker or locally, depending on config\n\n\nPica.prototype.__invokeResize = function (tileOpts, opts) {\n  var _this2 = this;\n\n  // Share cache between calls:\n  //\n  // - wasm instance\n  // - wasm memory object\n  //\n  opts.__mathCache = opts.__mathCache || {};\n  return Promise.resolve().then(function () {\n    if (!_this2.features.ww) {\n      // not possible to have ImageBitmap here if user disabled WW\n      return {\n        data: _this2.__mathlib.resizeAndUnsharp(tileOpts, opts.__mathCache)\n      };\n    }\n\n    return new Promise(function (resolve, reject) {\n      var w = _this2.__workersPool.acquire();\n\n      if (opts.cancelToken) opts.cancelToken[\"catch\"](function (err) {\n        return reject(err);\n      });\n\n      w.value.onmessage = function (ev) {\n        w.release();\n        if (ev.data.err) reject(ev.data.err);else resolve(ev.data);\n      };\n\n      var transfer = [];\n      if (tileOpts.src) transfer.push(tileOpts.src.buffer);\n      if (tileOpts.srcBitmap) transfer.push(tileOpts.srcBitmap);\n      w.value.postMessage({\n        opts: tileOpts,\n        features: _this2.__requested_features,\n        preload: {\n          wasm_nodule: _this2.__mathlib.__\n        }\n      }, transfer);\n    });\n  });\n}; // this function can return promise if createImageBitmap is used\n\n\nPica.prototype.__extractTileData = function (tile, from, opts, stageEnv, extractTo) {\n  if (this.features.ww && CAN_USE_OFFSCREEN_CANVAS && ( // createImageBitmap doesn't work for images (Image, ImageBitmap) with Exif orientation in Chrome,\n  // can use canvas because canvas doesn't have orientation;\n  // see https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n  utils.isCanvas(from) || CAN_USE_CIB_REGION_FOR_IMAGE)) {\n    this.debug('Create tile for OffscreenCanvas');\n    return createImageBitmap(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height).then(function (bitmap) {\n      extractTo.srcBitmap = bitmap;\n      return extractTo;\n    });\n  } // Extract tile RGBA buffer, depending on input type\n\n\n  if (utils.isCanvas(from)) {\n    if (!stageEnv.srcCtx) stageEnv.srcCtx = from.getContext('2d'); // If input is Canvas - extract region data directly\n\n    this.debug('Get tile pixel data');\n    extractTo.src = stageEnv.srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height).data;\n    return extractTo;\n  } // If input is Image or decoded to ImageBitmap,\n  // draw region to temporary canvas and extract data from it\n  //\n  // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n  //\n\n\n  this.debug('Draw tile imageBitmap/image to temporary canvas');\n  var tmpCanvas = this.options.createCanvas(tile.width, tile.height);\n  var tmpCtx = tmpCanvas.getContext('2d');\n  tmpCtx.globalCompositeOperation = 'copy';\n  tmpCtx.drawImage(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n  this.debug('Get tile pixel data');\n  extractTo.src = tmpCtx.getImageData(0, 0, tile.width, tile.height).data; // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n\n  tmpCanvas.width = tmpCanvas.height = 0;\n  return extractTo;\n};\n\nPica.prototype.__landTileData = function (tile, result, stageEnv) {\n  var toImageData;\n  this.debug('Convert raw rgba tile result to ImageData');\n\n  if (result.bitmap) {\n    stageEnv.toCtx.drawImage(result.bitmap, tile.toX, tile.toY);\n    return null;\n  }\n\n  if (CAN_NEW_IMAGE_DATA) {\n    // this branch is for modern browsers\n    // If `new ImageData()` & Uint8ClampedArray suported\n    toImageData = new ImageData(new Uint8ClampedArray(result.data), tile.toWidth, tile.toHeight);\n  } else {\n    // fallback for `node-canvas` and old browsers\n    // (IE11 has ImageData but does not support `new ImageData()`)\n    toImageData = stageEnv.toCtx.createImageData(tile.toWidth, tile.toHeight);\n\n    if (toImageData.data.set) {\n      toImageData.data.set(result.data);\n    } else {\n      // IE9 don't have `.set()`\n      for (var i = toImageData.data.length - 1; i >= 0; i--) {\n        toImageData.data[i] = result.data[i];\n      }\n    }\n  }\n\n  this.debug('Draw tile');\n\n  if (NEED_SAFARI_FIX) {\n    // Safari draws thin white stripes between tiles without this fix\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n  } else {\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n  }\n\n  return null;\n};\n\nPica.prototype.__tileAndResize = function (from, to, opts) {\n  var _this3 = this;\n\n  var stageEnv = {\n    srcCtx: null,\n    srcImageBitmap: null,\n    isImageBitmapReused: false,\n    toCtx: null\n  };\n\n  var processTile = function processTile(tile) {\n    return _this3.__limit(function () {\n      if (opts.canceled) return opts.cancelToken;\n      var tileOpts = {\n        width: tile.width,\n        height: tile.height,\n        toWidth: tile.toWidth,\n        toHeight: tile.toHeight,\n        scaleX: tile.scaleX,\n        scaleY: tile.scaleY,\n        offsetX: tile.offsetX,\n        offsetY: tile.offsetY,\n        filter: opts.filter,\n        unsharpAmount: opts.unsharpAmount,\n        unsharpRadius: opts.unsharpRadius,\n        unsharpThreshold: opts.unsharpThreshold\n      };\n\n      _this3.debug('Invoke resize math');\n\n      return Promise.resolve(tileOpts).then(function (tileOpts) {\n        return _this3.__extractTileData(tile, from, opts, stageEnv, tileOpts);\n      }).then(function (tileOpts) {\n        _this3.debug('Invoke resize math');\n\n        return _this3.__invokeResize(tileOpts, opts);\n      }).then(function (result) {\n        if (opts.canceled) return opts.cancelToken;\n        stageEnv.srcImageData = null;\n        return _this3.__landTileData(tile, result, stageEnv);\n      });\n    });\n  }; // Need to normalize data source first. It can be canvas or image.\n  // If image - try to decode in background if possible\n\n\n  return Promise.resolve().then(function () {\n    stageEnv.toCtx = to.getContext('2d');\n    if (utils.isCanvas(from)) return null;\n\n    if (utils.isImageBitmap(from)) {\n      stageEnv.srcImageBitmap = from;\n      stageEnv.isImageBitmapReused = true;\n      return null;\n    }\n\n    if (utils.isImage(from)) {\n      // try do decode image in background for faster next operations;\n      // if we're using offscreen canvas, cib is called per tile, so not needed here\n      if (!CAN_CREATE_IMAGE_BITMAP) return null;\n\n      _this3.debug('Decode image via createImageBitmap');\n\n      return createImageBitmap(from).then(function (imageBitmap) {\n        stageEnv.srcImageBitmap = imageBitmap;\n      }) // Suppress error to use fallback, if method fails\n      // https://github.com/nodeca/pica/issues/190\n\n      /* eslint-disable no-unused-vars */\n      [\"catch\"](function (e) {\n        return null;\n      });\n    }\n\n    throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n  }).then(function () {\n    if (opts.canceled) return opts.cancelToken;\n\n    _this3.debug('Calculate tiles'); //\n    // Here we are with \"normalized\" source,\n    // follow to tiling\n    //\n\n\n    var regions = createRegions({\n      width: opts.width,\n      height: opts.height,\n      srcTileSize: _this3.options.tile,\n      toWidth: opts.toWidth,\n      toHeight: opts.toHeight,\n      destTileBorder: opts.__destTileBorder\n    });\n    var jobs = regions.map(function (tile) {\n      return processTile(tile);\n    });\n\n    function cleanup(stageEnv) {\n      if (stageEnv.srcImageBitmap) {\n        if (!stageEnv.isImageBitmapReused) stageEnv.srcImageBitmap.close();\n        stageEnv.srcImageBitmap = null;\n      }\n    }\n\n    _this3.debug('Process tiles');\n\n    return Promise.all(jobs).then(function () {\n      _this3.debug('Finished!');\n\n      cleanup(stageEnv);\n      return to;\n    }, function (err) {\n      cleanup(stageEnv);\n      throw err;\n    });\n  });\n};\n\nPica.prototype.__processStages = function (stages, from, to, opts) {\n  var _this4 = this;\n\n  if (opts.canceled) return opts.cancelToken;\n\n  var _stages$shift = stages.shift(),\n      _stages$shift2 = _slicedToArray(_stages$shift, 2),\n      toWidth = _stages$shift2[0],\n      toHeight = _stages$shift2[1];\n\n  var isLastStage = stages.length === 0; // Optimization for legacy filters -\n  // only use user-defined quality for the last stage,\n  // use simpler (Hamming) filter for the first stages where\n  // scale factor is large enough (more than 2-3)\n  //\n  // For advanced filters (mks2013 and custom) - skip optimization,\n  // because need to apply sharpening every time\n\n  var filter;\n  if (isLastStage || filter_info.q2f.indexOf(opts.filter) < 0) filter = opts.filter;else if (opts.filter === 'box') filter = 'box';else filter = 'hamming';\n  opts = assign({}, opts, {\n    toWidth: toWidth,\n    toHeight: toHeight,\n    filter: filter\n  });\n  var tmpCanvas;\n\n  if (!isLastStage) {\n    // create temporary canvas\n    tmpCanvas = this.options.createCanvas(toWidth, toHeight);\n  }\n\n  return this.__tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n    if (isLastStage) return to;\n    opts.width = toWidth;\n    opts.height = toHeight;\n    return _this4.__processStages(stages, tmpCanvas, to, opts);\n  }).then(function (res) {\n    if (tmpCanvas) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      tmpCanvas.width = tmpCanvas.height = 0;\n    }\n\n    return res;\n  });\n};\n\nPica.prototype.__resizeViaCreateImageBitmap = function (from, to, opts) {\n  var _this5 = this;\n\n  var toCtx = to.getContext('2d');\n  this.debug('Resize via createImageBitmap()');\n  return createImageBitmap(from, {\n    resizeWidth: opts.toWidth,\n    resizeHeight: opts.toHeight,\n    resizeQuality: utils.cib_quality_name(filter_info.f2q[opts.filter])\n  }).then(function (imageBitmap) {\n    if (opts.canceled) return opts.cancelToken; // if no unsharp - draw directly to output canvas\n\n    if (!opts.unsharpAmount) {\n      toCtx.drawImage(imageBitmap, 0, 0);\n      imageBitmap.close();\n      toCtx = null;\n\n      _this5.debug('Finished!');\n\n      return to;\n    }\n\n    _this5.debug('Unsharp result');\n\n    var tmpCanvas = _this5.options.createCanvas(opts.toWidth, opts.toHeight);\n\n    var tmpCtx = tmpCanvas.getContext('2d');\n    tmpCtx.drawImage(imageBitmap, 0, 0);\n    imageBitmap.close();\n    var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n\n    _this5.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n\n    toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n    // https://github.com/nodeca/pica/issues/199\n\n    tmpCanvas.width = tmpCanvas.height = 0;\n    iData = tmpCtx = tmpCanvas = toCtx = null;\n\n    _this5.debug('Finished!');\n\n    return to;\n  });\n};\n\nPica.prototype.resize = function (from, to, options) {\n  var _this6 = this;\n\n  this.debug('Start resize...');\n  var opts = assign({}, DEFAULT_RESIZE_OPTS);\n\n  if (!isNaN(options)) {\n    opts = assign(opts, {\n      quality: options\n    });\n  } else if (options) {\n    opts = assign(opts, options);\n  }\n\n  opts.toWidth = to.width;\n  opts.toHeight = to.height;\n  opts.width = from.naturalWidth || from.width;\n  opts.height = from.naturalHeight || from.height; // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  } // Prevent stepper from infinite loop\n\n\n  if (to.width === 0 || to.height === 0) {\n    return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n  }\n\n  if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n  opts.canceled = false;\n\n  if (opts.cancelToken) {\n    // Wrap cancelToken to avoid successive resolve & set flag\n    opts.cancelToken = opts.cancelToken.then(function (data) {\n      opts.canceled = true;\n      throw data;\n    }, function (err) {\n      opts.canceled = true;\n      throw err;\n    });\n  }\n\n  var DEST_TILE_BORDER = 3; // Max possible filter window size\n\n  opts.__destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n  return this.init().then(function () {\n    if (opts.canceled) return opts.cancelToken; // if createImageBitmap supports resize, just do it and return\n\n    if (_this6.features.cib) {\n      if (filter_info.q2f.indexOf(opts.filter) >= 0) {\n        return _this6.__resizeViaCreateImageBitmap(from, to, opts);\n      }\n\n      _this6.debug('cib is enabled, but not supports provided filter, fallback to manual math');\n    }\n\n    if (!CAN_USE_CANVAS_GET_IMAGE_DATA) {\n      var err = new Error('Pica: cannot use getImageData on canvas, ' + \"make sure fingerprinting protection isn't enabled\");\n      err.code = 'ERR_GET_IMAGE_DATA';\n      throw err;\n    } //\n    // No easy way, let's resize manually via arrays\n    //\n\n\n    var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this6.options.tile, opts.__destTileBorder);\n    return _this6.__processStages(stages, from, to, opts);\n  });\n}; // RGBA buffer resize\n//\n\n\nPica.prototype.resizeBuffer = function (options) {\n  var _this7 = this;\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS, options); // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  }\n\n  return this.init().then(function () {\n    return _this7.__mathlib.resizeAndUnsharp(opts);\n  });\n};\n\nPica.prototype.toBlob = function (canvas, mimeType, quality) {\n  mimeType = mimeType || 'image/png';\n  return new Promise(function (resolve) {\n    if (canvas.toBlob) {\n      canvas.toBlob(function (blob) {\n        return resolve(blob);\n      }, mimeType, quality);\n      return;\n    }\n\n    if (canvas.convertToBlob) {\n      resolve(canvas.convertToBlob({\n        type: mimeType,\n        quality: quality\n      }));\n      return;\n    } // Fallback for old browsers\n\n\n    var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n    var len = asString.length;\n    var asBuffer = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      asBuffer[i] = asString.charCodeAt(i);\n    }\n\n    resolve(new Blob([asBuffer], {\n      type: mimeType\n    }));\n  });\n};\n\nPica.prototype.debug = function () {};\n\nmodule.exports = Pica;\n\n},{\"./lib/mathlib\":1,\"./lib/mm_resize/resize_filter_info\":7,\"./lib/pool\":13,\"./lib/stepper\":14,\"./lib/tiler\":15,\"./lib/utils\":16,\"./lib/worker\":17,\"object-assign\":22,\"webworkify\":23}]},{},[])(\"/index.js\")\n});\n}(pica$1));\n\nvar jpeg_plugins = {};\n\nvar image_traverse$1 = {exports: {}};\n\n(function (module) {\n\n//////////////////////////////////////////////////////////////////////////\n// Helpers\n//\nfunction error(message, code) {\n  var err = new Error(message);\n  err.code = code;\n  return err;\n}\n\n\n// Convert number to 0xHH string\n//\nfunction to_hex(number) {\n  var n = number.toString(16).toUpperCase();\n  for (var i = 2 - n.length; i > 0; i--) n = '0' + n;\n  return '0x' + n;\n}\n\n\nfunction utf8_encode(str) {\n  try {\n    return unescape(encodeURIComponent(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\nfunction utf8_decode(str) {\n  try {\n    return decodeURIComponent(escape(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\n// Check if input is a Uint8Array\n//\nfunction is_uint8array(bin) {\n  return Object.prototype.toString.call(bin) === '[object Uint8Array]';\n}\n\n\n//////////////////////////////////////////////////////////////////////////\n// Exif parser\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - exif_start: Number     - start of TIFF header (after Exif\\0\\0)\n//  - exif_end:   Number     - end of Exif segment\n//  - on_entry:   Number     - callback\n//\nfunction ExifParser(jpeg_bin, exif_start, exif_end) {\n  // Uint8Array, exif without signature (which isn't included in offsets)\n  this.input      = jpeg_bin.subarray(exif_start, exif_end);\n\n  // offset correction for `on_entry` callback\n  this.start      = exif_start;\n\n  // Check TIFF header (includes byte alignment and first IFD offset)\n  var sig = String.fromCharCode.apply(null, this.input.subarray(0, 4));\n\n  if (sig !== 'II\\x2A\\0' && sig !== 'MM\\0\\x2A') {\n    throw error('invalid TIFF signature', 'EBADDATA');\n  }\n\n  // true if motorola (big endian) byte alignment, false if intel\n  this.big_endian = sig[0] === 'M';\n}\n\n\nExifParser.prototype.each = function (on_entry) {\n  // allow premature exit\n  this.aborted = false;\n\n  var offset = this.read_uint32(4);\n\n  this.ifds_to_read = [ {\n    id:     0,\n    offset: offset\n  } ];\n\n  while (this.ifds_to_read.length > 0 && !this.aborted) {\n    var i = this.ifds_to_read.shift();\n    if (!i.offset) continue;\n    this.scan_ifd(i.id, i.offset, on_entry);\n  }\n};\n\n\nExifParser.prototype.filter = function (on_entry) {\n  var ifds = {};\n\n  // make sure IFD0 always exists\n  ifds.ifd0 = { id: 0, entries: [] };\n\n  this.each(function (entry) {\n    if (on_entry(entry) === false && !entry.is_subifd_link) return;\n    if (entry.is_subifd_link && entry.count !== 1 && entry.format !== 4) return; // filter out bogus links\n\n    if (!ifds['ifd' + entry.ifd]) {\n      ifds['ifd' + entry.ifd] = { id: entry.ifd, entries: [] };\n    }\n\n    ifds['ifd' + entry.ifd].entries.push(entry);\n  });\n\n  // thumbnails are not supported just yet, so delete all information related to it\n  delete ifds.ifd1;\n\n  // Calculate output size\n  var length = 8;\n  Object.keys(ifds).forEach(function (ifd_no) {\n    length += 2;\n\n    ifds[ifd_no].entries.forEach(function (entry) {\n      length += 12 + (entry.data_length > 4 ? Math.ceil(entry.data_length / 2) * 2 : 0);\n    });\n\n    length += 4;\n  });\n\n  this.output = new Uint8Array(length);\n  this.output[0] = this.output[1] = (this.big_endian ? 'M' : 'I').charCodeAt(0);\n  this.write_uint16(2, 0x2A);\n\n  var offset = 8;\n  var self = this;\n  this.write_uint32(4, offset);\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    ifds[ifd_no].written_offset = offset;\n\n    var ifd_start = offset;\n    var ifd_end   = ifd_start + 2 + ifds[ifd_no].entries.length * 12 + 4;\n    offset = ifd_end;\n\n    self.write_uint16(ifd_start, ifds[ifd_no].entries.length);\n\n    ifds[ifd_no].entries.sort(function (a, b) {\n      // IFD entries must be in order of increasing tag IDs\n      return a.tag - b.tag;\n    }).forEach(function (entry, idx) {\n      var entry_offset = ifd_start + 2 + idx * 12;\n\n      self.write_uint16(entry_offset, entry.tag);\n      self.write_uint16(entry_offset + 2, entry.format);\n      self.write_uint32(entry_offset + 4, entry.count);\n\n      if (entry.is_subifd_link) {\n        // filled in later\n        if (ifds['ifd' + entry.tag]) ifds['ifd' + entry.tag].link_offset = entry_offset + 8;\n      } else if (entry.data_length <= 4) {\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + 4),\n          entry_offset + 8\n        );\n      } else {\n        self.write_uint32(entry_offset + 8, offset);\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + entry.data_length),\n          offset\n        );\n        offset += Math.ceil(entry.data_length / 2) * 2;\n      }\n    });\n\n    var next_ifd = ifds['ifd' + (ifds[ifd_no].id + 1)];\n    if (next_ifd) next_ifd.link_offset = ifd_end - 4;\n  });\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    if (ifds[ifd_no].written_offset && ifds[ifd_no].link_offset) {\n      self.write_uint32(ifds[ifd_no].link_offset, ifds[ifd_no].written_offset);\n    }\n  });\n\n  if (this.output.length !== offset) throw error('internal error: incorrect buffer size allocated');\n\n  return this.output;\n};\n\n\nExifParser.prototype.read_uint16 = function (offset) {\n  var d = this.input;\n  if (offset + 2 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x100 + d[offset + 1] :\n    d[offset] + d[offset + 1] * 0x100;\n};\n\n\nExifParser.prototype.read_uint32 = function (offset) {\n  var d = this.input;\n  if (offset + 4 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x1000000 + d[offset + 1] * 0x10000 + d[offset + 2] * 0x100 + d[offset + 3] :\n    d[offset] + d[offset + 1] * 0x100 + d[offset + 2] * 0x10000 + d[offset + 3] * 0x1000000;\n};\n\n\nExifParser.prototype.write_uint16 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 8) & 0xFF;\n    d[offset + 1] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.write_uint32 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 24) & 0xFF;\n    d[offset + 1] = (value >>> 16) & 0xFF;\n    d[offset + 2] = (value >>> 8) & 0xFF;\n    d[offset + 3] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n    d[offset + 2] = (value >>> 16) & 0xFF;\n    d[offset + 3] = (value >>> 24) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.is_subifd_link = function (ifd, tag) {\n  return (ifd === 0 && tag === 0x8769) || // SubIFD\n         (ifd === 0 && tag === 0x8825) || // GPS Info\n         (ifd === 0x8769 && tag === 0xA005); // Interop IFD\n};\n\n\n// Returns byte length of a single component of a given format\n//\nExifParser.prototype.exif_format_length = function (format) {\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n    case 6: // sbyte\n    case 7: // undefined\n      return 1;\n\n    case 3: // short\n    case 8: // sshort\n      return 2;\n\n    case 4:  // long\n    case 9:  // slong\n    case 11: // float\n      return 4;\n\n    case 5:  // rational\n    case 10: // srational\n    case 12: // double\n      return 8;\n\n    default:\n      // unknown type\n      return 0;\n  }\n};\n\n\n// Reads Exif data\n//\nExifParser.prototype.exif_format_read = function (format, offset) {\n  var v;\n\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n      v = this.input[offset];\n      return v;\n\n    case 6: // sbyte\n      v = this.input[offset];\n      return v | (v & 0x80) * 0x1fffffe;\n\n    case 3: // short\n      v = this.read_uint16(offset);\n      return v;\n\n    case 8: // sshort\n      v = this.read_uint16(offset);\n      return v | (v & 0x8000) * 0x1fffe;\n\n    case 4: // long\n      v = this.read_uint32(offset);\n      return v;\n\n    case 9: // slong\n      v = this.read_uint32(offset);\n      return v | 0;\n\n    case 5:  // rational\n    case 10: // srational\n    case 11: // float\n    case 12: // double\n      return null; // not implemented\n\n    case 7: // undefined\n      return null; // blob\n\n    default:\n      // unknown type\n      return null;\n  }\n};\n\n\nExifParser.prototype.scan_ifd = function (ifd_no, offset, on_entry) {\n  var entry_count = this.read_uint16(offset);\n\n  offset += 2;\n\n  for (var i = 0; i < entry_count; i++) {\n    var tag    = this.read_uint16(offset);\n    var format = this.read_uint16(offset + 2);\n    var count  = this.read_uint32(offset + 4);\n\n    var comp_length    = this.exif_format_length(format);\n    var data_length    = count * comp_length;\n    var data_offset    = data_length <= 4 ? offset + 8 : this.read_uint32(offset + 8);\n    var is_subifd_link = false;\n\n    if (data_offset + data_length > this.input.length) {\n      throw error('unexpected EOF', 'EBADDATA');\n    }\n\n    var value = [];\n    var comp_offset = data_offset;\n\n    for (var j = 0; j < count; j++, comp_offset += comp_length) {\n      var item = this.exif_format_read(format, comp_offset);\n      if (item === null) {\n        value = null;\n        break;\n      }\n      value.push(item);\n    }\n\n    if (Array.isArray(value) && format === 2) {\n      try {\n        value = utf8_decode(String.fromCharCode.apply(null, value));\n      } catch (_) {\n        value = null;\n      }\n\n      if (value && value[value.length - 1] === '\\0') value = value.slice(0, -1);\n    }\n\n    if (this.is_subifd_link(ifd_no, tag)) {\n      if (Array.isArray(value) && Number.isInteger(value[0]) && value[0] > 0) {\n        this.ifds_to_read.push({\n          id:     tag,\n          offset: value[0]\n        });\n        is_subifd_link = true;\n      }\n    }\n\n    var entry = {\n      is_big_endian:  this.big_endian,\n      ifd:            ifd_no,\n      tag:            tag,\n      format:         format,\n      count:          count,\n      entry_offset:   offset + this.start,\n      data_length:    data_length,\n      data_offset:    data_offset + this.start,\n      value:          value,\n      is_subifd_link: is_subifd_link\n    };\n\n    if (on_entry(entry) === false) {\n      this.aborted = true;\n      return;\n    }\n\n    offset += 12;\n  }\n\n  if (ifd_no === 0) {\n    this.ifds_to_read.push({\n      id:     1,\n      offset: this.read_uint32(offset)\n    });\n  }\n};\n\n\n// Check whether input is a JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//\n// Returns true if it is and false otherwise\n//\nmodule.exports.is_jpeg = function (jpeg_bin) {\n  return jpeg_bin.length >= 4 && jpeg_bin[0] === 0xFF && jpeg_bin[1] === 0xD8 && jpeg_bin[2] === 0xFF;\n};\n\n\n// Call an iterator on each segment in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// Iteration stops when `EOI` (0xFFD9) marker is reached or if `on_segment`\n// function returns `false`.\n//\nmodule.exports.jpeg_segments_each = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  if (!module.exports.is_jpeg(jpeg_bin)) {\n    throw error('Unknown file format', 'ENOTJPEG');\n  }\n\n  var offset = 0, length = jpeg_bin.length, inside_scan = false;\n\n  for (;;) {\n    var segment_code, segment_length;\n\n    if (offset + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n    var byte1 = jpeg_bin[offset];\n    var byte2 = jpeg_bin[offset + 1];\n\n    if (byte1 === 0xFF && byte2 === 0xFF) {\n      // padding\n      segment_code = 0xFF;\n      segment_length = 1;\n\n    } else if (byte1 === 0xFF && byte2 !== 0) {\n      // marker\n      segment_code = byte2;\n      segment_length = 2;\n\n      if ((0xD0 <= segment_code && segment_code <= 0xD9) || segment_code === 0x01) ; else {\n        if (offset + 3 >= length) throw error('Unexpected EOF', 'EBADDATA');\n        segment_length += jpeg_bin[offset + 2] * 0x100 + jpeg_bin[offset + 3];\n        if (segment_length < 2) throw error('Invalid segment length', 'EBADDATA');\n        if (offset + segment_length - 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n      }\n\n      if (inside_scan) {\n        if (segment_code >= 0xD0 && segment_code <= 0xD7) ; else {\n          inside_scan = false;\n        }\n      }\n\n      if (segment_code === 0xDA /* SOS */) inside_scan = true;\n    } else if (inside_scan) {\n      // entropy-encoded segment\n      for (var pos = offset + 1; ; pos++) {\n        // scan until we find FF\n        if (pos >= length) throw error('Unexpected EOF', 'EBADDATA');\n        if (jpeg_bin[pos] === 0xFF) {\n          if (pos + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n          if (jpeg_bin[pos + 1] !== 0) {\n            segment_code = 0;\n            segment_length = pos - offset;\n            break;\n          }\n        }\n      }\n    } else {\n      throw error('Unexpected byte at segment start: ' + to_hex(byte1) +\n        ' (offset ' + to_hex(offset) + ')', 'EBADDATA');\n    }\n\n    if (on_segment({ code: segment_code, offset: offset, length: segment_length }) === false) break;\n    if (segment_code === 0xD9 /* EOI */) break;\n    offset += segment_length;\n  }\n};\n\n\n// Replace or remove segments in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// `on_segment` function should return one of the following:\n//  - `false`        - segment is removed from the output\n//  - Uint8Array     - segment is replaced with the new data\n//  - [ Uint8Array ] - segment is replaced with the new data\n//  - anything else  - segment is copied to the output as is\n//\n// Any data after `EOI` (0xFFD9) marker is removed.\n//\nmodule.exports.jpeg_segments_filter = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  var ranges = [];\n  var out_length = 0;\n\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    var new_segment = on_segment(segment);\n\n    if (is_uint8array(new_segment)) {\n      ranges.push({ data: new_segment });\n      out_length += new_segment.length;\n    } else if (Array.isArray(new_segment)) {\n      new_segment.filter(is_uint8array).forEach(function (s) {\n        ranges.push({ data: s });\n        out_length += s.length;\n      });\n    } else if (new_segment !== false) {\n      var new_range = { start: segment.offset, end: segment.offset + segment.length };\n\n      if (ranges.length > 0 && ranges[ranges.length - 1].end === new_range.start) {\n        ranges[ranges.length - 1].end = new_range.end;\n      } else {\n        ranges.push(new_range);\n      }\n\n      out_length += segment.length;\n    }\n  });\n\n  var result = new Uint8Array(out_length);\n  var offset = 0;\n\n  ranges.forEach(function (range) {\n    var data = range.data || jpeg_bin.subarray(range.start, range.end);\n    result.set(data, offset);\n    offset += data.length;\n  });\n\n  return result;\n};\n\n\n// Call an iterator on each Exif entry in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                 0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                 (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// Iteration stops early if iterator returns `false`.\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed.\n//\nmodule.exports.jpeg_exif_tags_each = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  /* eslint-disable consistent-return */\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    if (segment.code === 0xDA /* SOS */) return false;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length).each(on_exif_entry);\n      return false;\n    }\n  });\n};\n\n\n// Remove Exif entries in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                  0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                  (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// This function removes following from Exif:\n//  - all entries where iterator returned false (except subifd links which are mandatory)\n//  - IFD1 and thumbnail image (the purpose of this function is to reduce file size,\n//    so thumbnail is usually the first thing to go)\n//  - all other data that isn't in IFD0, SubIFD, GPSIFD, InteropIFD\n//    (theoretically possible proprietary extensions, I haven't seen any of these yet)\n//\n// Changing data inside Exif entries is NOT supported yet (modifying `entry` object inside callback may break stuff).\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed, and original JPEG is returned as is.\n//\nmodule.exports.jpeg_exif_tags_filter = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  var stop_search = false;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    if (stop_search) return;\n    if (segment.code === 0xDA /* SOS */) stop_search = true;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      var new_exif = new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length)\n        .filter(on_exif_entry);\n      if (!new_exif) return false;\n\n      var header = new Uint8Array(10);\n\n      header.set(jpeg_bin.slice(segment.offset, segment.offset + 10));\n      header[2] = ((new_exif.length + 8) >>> 8) & 0xFF;\n      header[3] = (new_exif.length + 8) & 0xFF;\n\n      stop_search = true;\n      return [ header, new_exif ];\n    }\n  });\n};\n\n\n// Inserts a custom comment marker segment into JPEG file.\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - comment:  String\n//\n// Comment is inserted after first two bytes (FFD8, SOI).\n//\n// If JFIF (APP0) marker exists immediately after SOI (as mandated by the JFIF\n// spec), we insert comment after it instead.\n//\nmodule.exports.jpeg_add_comment = function (jpeg_bin, comment) {\n  var comment_inserted = false, segment_count = 0;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    segment_count++;\n    if (segment_count === 1 && segment.code === 0xD8 /* SOI  */) return;\n    if (segment_count === 2 && segment.code === 0xE0 /* APP0 */) return;\n\n    if (comment_inserted) return;\n    comment = utf8_encode(comment);\n\n    // comment segment\n    var csegment = new Uint8Array(5 + comment.length);\n    var offset = 0;\n\n    csegment[offset++] = 0xFF;\n    csegment[offset++] = 0xFE;\n    csegment[offset++] = ((comment.length + 3) >>> 8) & 0xFF;\n    csegment[offset++] = (comment.length + 3) & 0xFF;\n\n    comment.split('').forEach(function (c) {\n      csegment[offset++] = c.charCodeAt(0) & 0xFF;\n    });\n\n    csegment[offset++] = 0;\n    comment_inserted = true;\n\n    return [ csegment, jpeg_bin.subarray(segment.offset, segment.offset + segment.length) ];\n  });\n};\n}(image_traverse$1));\n\nvar image_traverse = image_traverse$1.exports;\n\n\nfunction jpeg_patch_exif(env) {\n  return this._getUint8Array(env.blob).then(function (data) {\n    env.is_jpeg = image_traverse.is_jpeg(data);\n\n    if (!env.is_jpeg) return Promise.resolve(env);\n\n    env.orig_blob = env.blob;\n\n    try {\n      var exif_is_big_endian, orientation_offset;\n\n      /* eslint-disable consistent-return */\n      image_traverse.jpeg_exif_tags_each(data, function (entry) {\n        if (entry.ifd === 0 && entry.tag === 0x112 && Array.isArray(entry.value)) {\n          env.orientation    = entry.value[0] || 1;\n          exif_is_big_endian = entry.is_big_endian;\n          orientation_offset = entry.data_offset;\n          return false;\n        }\n      });\n\n      if (orientation_offset) {\n        var orientation_patch = exif_is_big_endian ?\n          new Uint8Array([ 0, 1 ]) :\n          new Uint8Array([ 1, 0 ]);\n\n        env.blob = new Blob([\n          data.slice(0, orientation_offset),\n          orientation_patch,\n          data.slice(orientation_offset + 2)\n        ], { type: 'image/jpeg' });\n      }\n    } catch (_) {}\n\n    return env;\n  });\n}\n\n\nfunction jpeg_rotate_canvas(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  var orientation = env.orientation - 1;\n  if (!orientation) return Promise.resolve(env);\n\n  var canvas;\n\n  if (orientation & 4) {\n    canvas = this.pica.options.createCanvas(env.out_canvas.height, env.out_canvas.width);\n  } else {\n    canvas = this.pica.options.createCanvas(env.out_canvas.width, env.out_canvas.height);\n  }\n\n  var ctx = canvas.getContext('2d');\n\n  ctx.save();\n\n  if (orientation & 1) ctx.transform(-1, 0, 0, 1, canvas.width, 0);\n  if (orientation & 2) ctx.transform(-1, 0, 0, -1, canvas.width, canvas.height);\n  if (orientation & 4) ctx.transform(0, 1, 1, 0, 0, 0);\n\n  ctx.drawImage(env.out_canvas, 0, 0);\n  ctx.restore();\n\n  // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n  env.out_canvas.width = env.out_canvas.height = 0;\n\n  env.out_canvas = canvas;\n\n  return Promise.resolve(env);\n}\n\n\nfunction jpeg_attach_orig_segments(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  return Promise.all([\n    this._getUint8Array(env.blob),\n    this._getUint8Array(env.out_blob)\n  ]).then(function (res) {\n    var data = res[0];\n    var data_out = res[1];\n\n    if (!image_traverse.is_jpeg(data)) return Promise.resolve(env);\n\n    var segments = [];\n\n    image_traverse.jpeg_segments_each(data, function (segment) {\n      if (segment.code === 0xDA /* SOS */) return false;\n      segments.push(segment);\n    });\n\n    segments = segments\n      .filter(function (segment) {\n        // Drop ICC_PROFILE\n        //\n        if (segment.code === 0xE2) return false;\n\n        // Keep all APPn segments excluding APP2 (ICC_PROFILE),\n        // remove others because most of them depend on image data (DCT and such).\n        //\n        // APP0 - JFIF, APP1 - Exif, the rest are photoshop metadata and such\n        //\n        // See full list at https://www.w3.org/Graphics/JPEG/itu-t81.pdf (table B.1 on page 32)\n        //\n        if (segment.code >= 0xE0 && segment.code < 0xF0) return true;\n\n        // Keep comments\n        //\n        if (segment.code === 0xFE) return true;\n\n        return false;\n      })\n      .map(function (segment) {\n        return data.slice(segment.offset, segment.offset + segment.length);\n      });\n\n    env.out_blob = new Blob(\n      // intentionally omitting expected JFIF segment (offset 2 to 20)\n      [ data_out.slice(0, 2) ].concat(segments).concat([ data_out.slice(20) ]),\n      { type: 'image/jpeg' }\n    );\n\n    return env;\n  });\n}\n\n\nfunction assign(reducer) {\n  reducer.before('_blob_to_image', jpeg_patch_exif);\n  reducer.after('_transform',      jpeg_rotate_canvas);\n  reducer.after('_create_blob',    jpeg_attach_orig_segments);\n}\n\n\njpeg_plugins.jpeg_patch_exif = jpeg_patch_exif;\njpeg_plugins.jpeg_rotate_canvas = jpeg_rotate_canvas;\njpeg_plugins.jpeg_attach_orig_segments = jpeg_attach_orig_segments;\njpeg_plugins.assign = assign;\n\nvar utils = utils$1;\nvar pica  = pica$1.exports;\n\nfunction ImageBlobReduce(options) {\n  if (!(this instanceof ImageBlobReduce)) return new ImageBlobReduce(options);\n\n  options = options || {};\n\n  this.pica = options.pica || pica({});\n  this.initialized = false;\n\n  this.utils = utils;\n}\n\n\nImageBlobReduce.prototype.use = function (plugin /*, params, ... */) {\n  var args = [ this ].concat(Array.prototype.slice.call(arguments, 1));\n  plugin.apply(plugin, args);\n  return this;\n};\n\n\nImageBlobReduce.prototype.init = function () {\n  this.use(jpeg_plugins.assign);\n};\n\n\nImageBlobReduce.prototype.toBlob = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(this._create_blob)\n    .then(function (_env) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      _env.out_canvas.width = _env.out_canvas.height = 0;\n\n      return _env.out_blob;\n    });\n};\n\n\nImageBlobReduce.prototype.toCanvas = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(function (_env) { return _env.out_canvas; });\n};\n\n\nImageBlobReduce.prototype.before = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return fn.call(self, env).then(function (_env) {\n      return old_fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype.after = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return old_fn.call(self, env).then(function (_env) {\n      return fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype._blob_to_image = function (env) {\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n  env.image = document.createElement('img');\n  env.image_url = URL.createObjectURL(env.blob);\n  env.image.src = env.image_url;\n\n  return new Promise(function (resolve, reject) {\n    env.image.onerror = function () { reject(new Error('ImageBlobReduce: failed to create Image() from blob')); };\n    env.image.onload = function () { resolve(env); };\n  });\n};\n\n\nImageBlobReduce.prototype._calculate_size = function (env) {\n  //\n  // Note, if your need not \"symmetric\" resize logic, you MUST check\n  // `env.orientation` (set by plugins) and swap width/height appropriately.\n  //\n  var scale_factor = env.opts.max / Math.max(env.image.width, env.image.height);\n\n  if (scale_factor > 1) scale_factor = 1;\n\n  env.transform_width = Math.max(Math.round(env.image.width * scale_factor), 1);\n  env.transform_height = Math.max(Math.round(env.image.height * scale_factor), 1);\n\n  // Info for user plugins, to check if scaling applied\n  env.scale_factor = scale_factor;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._transform = function (env) {\n  env.out_canvas = this.pica.options.createCanvas(env.transform_width, env.transform_height);\n\n  // Dim env temporary vars to prohibit use and avoid confusion when orientation\n  // changed. You should take real size from canvas.\n  env.transform_width = null;\n  env.transform_height = null;\n\n  // By default use alpha for png only\n  var pica_opts = { alpha: env.blob.type === 'image/png' };\n\n  // Extract pica options if been passed\n  this.utils.assign(pica_opts, this.utils.pick_pica_resize_options(env.opts));\n\n  return this.pica\n    .resize(env.image, env.out_canvas, pica_opts)\n    .then(function () { return env; });\n};\n\n\nImageBlobReduce.prototype._cleanup = function (env) {\n  env.image.src = '';\n  env.image = null;\n\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n  if (URL.revokeObjectURL) URL.revokeObjectURL(env.image_url);\n\n  env.image_url = null;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._create_blob = function (env) {\n  return this.pica.toBlob(env.out_canvas, env.blob.type)\n    .then(function (blob) {\n      env.out_blob = blob;\n      return env;\n    });\n};\n\n\nImageBlobReduce.prototype._getUint8Array = function (blob) {\n  if (blob.arrayBuffer) {\n    return blob.arrayBuffer().then(function (buf) {\n      return new Uint8Array(buf);\n    });\n  }\n\n  return new Promise(function (resolve, reject) {\n    var fr = new FileReader();\n\n    fr.readAsArrayBuffer(blob);\n\n    fr.onload = function () { resolve(new Uint8Array(fr.result)); };\n    fr.onerror = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob'));\n      fr.abort();\n    };\n    fr.onabort = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob (aborted)'));\n    };\n  });\n};\n\n\nImageBlobReduce.pica = pica;\n\nvar imageBlobReduce = ImageBlobReduce;\n\nexport { imageBlobReduce as default };\n"],
  "mappings": "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",
  "names": ["init_dirname", "init_buffer", "init_process", "commonjsRequire", "path", "utils$1", "to", "from", "s", "key", "pick", "props", "pick_pica_resize_options", "pica$1", "module", "exports", "f", "r", "e", "n", "t", "o", "i", "c", "u", "a", "p", "_dereq_", "Multimath", "mm_unsharp_mask", "mm_resize", "MathLib", "requested_features", "__requested_features", "features", "options", "cache", "result", "clampTo8", "clampNegative", "convolveHor", "src", "dest", "srcW", "srcH", "destW", "filters", "g", "b", "filterPtr", "filterShift", "filterSize", "srcPtr", "srcY", "destX", "filterVal", "srcOffset", "destOffset", "convolveVert", "convolveHorWithPre", "alpha", "convolveVertWithPre", "createFilters", "_require", "hasAlpha", "width", "height", "ptr", "len", "resetAlpha", "dst", "destH", "scaleX", "scaleY", "offsetX", "offsetY", "filter", "filtersX", "filtersY", "tmp", "FILTER_INFO", "FIXED_FRAC_BITS", "toFixedPoint", "num", "srcSize", "destSize", "scale", "offset", "filterFunction", "scaleInverted", "scaleClamped", "srcWindow", "destPixel", "srcPixel", "srcFirst", "srcLast", "filterElementSize", "floatFilter", "fxpFilter", "total", "pxl", "idx", "floatVal", "filterTotal", "leftNotEmpty", "rightNotEmpty", "maxFilterElementSize", "packedFilter", "packedFilterPtr", "slowCopy", "x", "xpi", "asUint8Array", "IS_LE", "copyInt16asLE", "target", "target_offset", "data", "src_offset", "src_size", "tmp_offset", "tmp_size", "filtersX_offset", "filtersY_offset", "alloc_bytes", "instance", "mem", "mem32", "src32", "fn", "dest32", "glur_mono16", "hsv_v16", "img", "size", "out", "max", "amount", "radius", "threshold", "v1", "v2", "vmul", "diff", "iTimes4", "brightness", "blured", "amountFp", "thresholdFp", "pixels", "img_bytes_cnt", "hsv_bytes_cnt", "blur_bytes_cnt", "blur_line_byte_cnt", "blur_coeffs_byte_cnt", "img_offset", "hsv_offset", "blur_offset", "blur_tmp_offset", "blur_line_offset", "blur_coeffs_offset", "img32", "GC_INTERVAL", "Pool", "create", "idle", "_this", "resource", "_this2", "_this3", "now", "MIN_INNER_TILE_SIZE", "fromWidth", "fromHeight", "toWidth", "toHeight", "srcTileSize", "destTileBorder", "minScale", "stageCount", "PIXEL_EPSILON", "pixelFloor", "nearest", "pixelCeil", "innerTileWidth", "innerTileHeight", "y", "innerX", "innerY", "toTileWidth", "toTileHeight", "tiles", "tile", "objClass", "obj", "element", "cname", "concurrency", "active", "queue", "roll", "resolve", "reject", "err", "createCanvas", "bitmap", "status", "workerPayload", "self", "canvas", "ctx", "code", "w", "ev", "usable", "d", "image", "mathLib", "tileOpts", "a0", "a1", "a2", "a3", "b1", "b2", "left_corner", "right_corner", "gaussCoef", "sigma", "g1", "g2", "k", "convolveMono16", "line", "coeff", "prev_src", "curr_src", "curr_out", "prev_out", "prev_prev_out", "src_index", "out_index", "line_index", "j", "coeff_a0", "coeff_a1", "coeff_b1", "coeff_b2", "blurMono16", "tmp_line", "assign", "base64decode", "hasWebAssembly", "DEFAULT_OPTIONS", "MultiMath", "opts", "name", "m", "bytes", "mem_size", "memsize", "env_extra", "env_base", "number", "base", "reminder", "BASE64_MAP", "str", "input", "bits", "tailbits", "wa", "bin", "getOwnPropertySymbols", "hasOwnProperty", "propIsEnumerable", "toObject", "val", "shouldUseNative", "test1", "test2", "order2", "test3", "letter", "source", "symbols", "bundleFn", "sources", "stringify", "wkey", "cacheKeys", "l", "exp", "wcache", "skey", "scache", "workerSources", "resolveSources", "depPath", "depKey", "URL", "blob", "workerUrl", "worker", "_slicedToArray", "arr", "_arrayWithHoles", "_iterableToArrayLimit", "_unsupportedIterableToArray", "_nonIterableRest", "minLen", "_arrayLikeToArray", "arr2", "_i", "_arr", "_n", "_d", "_s", "_e", "webworkify", "utils", "createStages", "createRegions", "filter_info", "singletones", "NEED_SAFARI_FIX", "DEFAULT_PICA_OPTS", "tmpCanvas", "DEFAULT_RESIZE_OPTS", "CAN_NEW_IMAGE_DATA", "CAN_CREATE_IMAGE_BITMAP", "CAN_USE_CANVAS_GET_IMAGE_DATA", "CAN_USE_OFFSCREEN_CANVAS", "CAN_USE_CIB_REGION_FOR_IMAGE", "workerFabric", "url", "Pica", "limiter_key", "wkr", "wpool_key", "initMath", "mathlib", "checkCibResize", "checkOffscreenCanvas", "checkCibRegion", "transfer", "stageEnv", "extractTo", "tmpCtx", "toImageData", "processTile", "imageBitmap", "regions", "jobs", "cleanup", "stages", "_this4", "_stages$shift", "_stages$shift2", "isLastStage", "res", "_this5", "toCtx", "iData", "_this6", "DEST_TILE_BORDER", "_this7", "mimeType", "quality", "asString", "asBuffer", "jpeg_plugins", "image_traverse$1", "error", "message", "to_hex", "utf8_encode", "utf8_decode", "is_uint8array", "ExifParser", "jpeg_bin", "exif_start", "exif_end", "sig", "on_entry", "ifds", "entry", "length", "ifd_no", "ifd_start", "ifd_end", "entry_offset", "next_ifd", "value", "ifd", "tag", "format", "v", "entry_count", "count", "comp_length", "data_length", "data_offset", "is_subifd_link", "comp_offset", "item", "on_segment", "inside_scan", "segment_code", "segment_length", "byte1", "byte2", "pos", "ranges", "out_length", "segment", "new_segment", "new_range", "range", "on_exif_entry", "stop_search", "new_exif", "header", "comment", "comment_inserted", "segment_count", "csegment", "image_traverse", "jpeg_patch_exif", "env", "exif_is_big_endian", "orientation_offset", "orientation_patch", "jpeg_rotate_canvas", "orientation", "jpeg_attach_orig_segments", "data_out", "segments", "reducer", "pica", "ImageBlobReduce", "plugin", "args", "_env", "method_name", "old_fn", "scale_factor", "pica_opts", "buf", "fr", "imageBlobReduce"]
}
