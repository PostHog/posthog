#!/usr/bin/env bash

set -euo pipefail

# Dev-only script to ensure persons database is up
# for services NOT managed by Docker Compose

DB_HOST=localhost
DB_PORT=5434
DB_NAME=posthog_persons
DB_USER=posthog
export PGPASSWORD=posthog

until psql -h $DB_HOST -p $DB_PORT -U $DB_USER -d $DB_NAME -c '\q' > /dev/null 2>&1; do
  echo "Awaiting Persons Database warmup..."
  sleep 1
done

echo "Persons Database is up!"
exit 0
