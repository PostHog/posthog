#!/bin/bash

echo "Running 'tsc -p tsconfig.strict.json'..."
echo ""

ALL_ERRORS=$(yarn typescript:check-strict 2> /dev/null | grep error | grep frontend)
ERRORS_COUNT=$(echo "${ALL_ERRORS}" | wc -l)
NEW_ERRORS=$(echo "${ALL_ERRORS}" | grep --invert-match --fixed-strings --file=.ts-strict-blacklist)

echo "In total there are ${ERRORS_COUNT} typescript errors."

if test -z "${NEW_ERRORS}"
then
    echo "No new typescript errors found in this PR! ðŸš€"
    exit 0
else
    echo "Found new typescript errors in this PR! ðŸ’¥"
    echo "${NEW_ERRORS}"
    exit 1
fi
