#!/bin/bash
# Starts a celery worker / heartbeat job. Must be run with a type of process: worker | beat

set -e

# this kills all processes when the last one terminates
trap 'kill $(jobs -p)' EXIT

source ./bin/celery-queues.env

# start celery worker with heartbeat (-B)
python manage.py run_autoreload_celery --type=$1