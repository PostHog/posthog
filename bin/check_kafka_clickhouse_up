#!/bin/bash

set -e

# Check Kafka
while true; do
nc -z localhost 9092 && break || docker ps -a --format 'Checking Kafka status...\n {{.Names}} {{.Image}} {{ .Status }}' && sleep 1
done

# Check ClickHouse
while true; do
curl -s -o /dev/null -I 'http://localhost:8123/' && break || docker ps -a -f name=clickhouse --format 'Checking ClickHouse status...\n {{.Names}} {{.Image}} {{ .Status }}' && sleep 1
done
