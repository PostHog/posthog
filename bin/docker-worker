#!/bin/bash
set -e

if [ -z "$REDIS_URL$POSTHOG_REDIS_HOST" ]
then
  echo "‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è"
  echo "Ô∏è‚ö†Ô∏è üö®üö®üö® PostHog warning! üö®üö®üö®"
  echo "‚ö†Ô∏è"
  echo "Ô∏è‚ö†Ô∏è The environment variable REDIS_URL or POSTHOG_REDIS_HOST is not configured!"
  echo "‚ö†Ô∏è Redis will be mandatory in the next versions of PostHog (1.1.0+)."
  echo "‚ö†Ô∏è Please configure it now to avoid future surprises!"
  echo "‚ö†Ô∏è"
  echo "‚ö†Ô∏è See here for more information!"
  echo "‚ö†Ô∏è --> https://docs.posthog.com/#/upgrading-posthog?id=upgrading-from-before-1011"
  echo "‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è"
else
  celery -A posthog beat -S redbeat.RedBeatScheduler &
  celery -A posthog worker
fi
