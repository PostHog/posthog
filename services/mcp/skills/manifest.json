{
    "version": "1.0.0",
    "resources": [
        {
            "name": "feature-flag-creation",
            "description": "Guide for creating feature flags via the PostHog AI agent tool, including the schema reference for FeatureFlagCreationSchema.",
            "files": [
                {
                    "path": "SKILL.md",
                    "content": "---\nname: feature-flag-creation\ndescription: Guide for creating feature flags via the PostHog AI agent tool, including the schema reference for FeatureFlagCreationSchema.\n---\n\n# Feature flag creation skill\n\nThis skill provides context for working with the AI-powered feature flag creation tool in PostHog.\n\n## FeatureFlagCreationSchema\n\nThe `CreateFeatureFlagTool` accepts natural language instructions and uses a taxonomy agent to produce a structured `FeatureFlagCreationSchema`. The schema fields are:\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `key` | string | yes | Unique flag key in kebab-case (e.g., 'new-dashboard', 'dark-mode'). Must only contain letters, numbers, underscores, and hyphens. Pattern: ^[a-zA-Z0-9_-]+$ |\n| `name` | string | yes | Human-readable flag name |\n| `description` | string | null | no | Optional description of what the flag controls |\n| `active` | boolean | no | Whether the flag is active |\n| `group_type` | string | null | no | Group type name for group-based targeting (e.g., 'organization', 'company') |\n| `groups` | array[#/$defs/FeatureFlagGroupType] | no | Feature flag groups containing properties and rollout percentage. Uses PostHog's native FeatureFlagGroupType schema. |\n| `tags` | array[string] | no | Tags for organizing and categorizing the flag |\n| `variants` | array | null | no | Multivariate variants for A/B testing. If provided, creates a multivariate flag. Variant rollout percentages should sum to 100. Common example: [{'key': 'control', 'name': 'Control', 'rollout_percentage': 50}, {'key': 'test', 'name': 'Test', 'rollout_percentage': 50}] |\n\n### Multivariate variants\n\nWhen the schema includes `variants`, each variant follows the `MultivariateVariant` schema:\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `key` | string | yes | Variant key (e.g., 'control', 'test', 'variant_a') |\n| `name` | string | null | no | Optional human-readable variant name |\n| `rollout_percentage` | integer | yes | Percentage of users assigned to this variant (0-100) |\n\n### Full JSON Schema\n\n<details>\n<summary>Expand FeatureFlagCreationSchema JSON Schema</summary>\n\n```json\n{\n  \"$defs\": {\n    \"CohortPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"cohort_name\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Cohort Name\"\n        },\n        \"key\": {\n          \"const\": \"id\",\n          \"default\": \"id\",\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"anyOf\": [\n            {\n              \"$ref\": \"#/$defs/PropertyOperator\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": \"in\"\n        },\n        \"type\": {\n          \"const\": \"cohort\",\n          \"default\": \"cohort\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"title\": \"Value\",\n          \"type\": \"integer\"\n        }\n      },\n      \"required\": [\n        \"value\"\n      ],\n      \"title\": \"CohortPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"DataWarehousePersonPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"data_warehouse_person_property\",\n          \"default\": \"data_warehouse_person_property\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"DataWarehousePersonPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"DataWarehousePropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"data_warehouse\",\n          \"default\": \"data_warehouse\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"DataWarehousePropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"DurationType\": {\n      \"enum\": [\n        \"duration\",\n        \"active_seconds\",\n        \"inactive_seconds\"\n      ],\n      \"title\": \"DurationType\",\n      \"type\": \"string\"\n    },\n    \"ElementPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"$ref\": \"#/$defs/Key\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"element\",\n          \"default\": \"element\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"ElementPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"EmptyPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"type\": {\n          \"const\": \"empty\",\n          \"default\": \"empty\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        }\n      },\n      \"title\": \"EmptyPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"ErrorTrackingIssueFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"error_tracking_issue\",\n          \"default\": \"error_tracking_issue\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"ErrorTrackingIssueFilter\",\n      \"type\": \"object\"\n    },\n    \"EventMetadataPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"event_metadata\",\n          \"default\": \"event_metadata\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"EventMetadataPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"EventPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"anyOf\": [\n            {\n              \"$ref\": \"#/$defs/PropertyOperator\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": \"exact\"\n        },\n        \"type\": {\n          \"const\": \"event\",\n          \"default\": \"event\",\n          \"description\": \"Event properties\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\"\n      ],\n      \"title\": \"EventPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"FeatureFlagGroupType\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"description\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Description\"\n        },\n        \"properties\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"$ref\": \"#/$defs/EventPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/PersonPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/ElementPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/EventMetadataPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/SessionPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/CohortPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/RecordingPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/LogEntryPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/GroupPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/FeaturePropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/FlagPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/HogQLPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/EmptyPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/DataWarehousePropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/DataWarehousePersonPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/ErrorTrackingIssueFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/LogPropertyFilter\"\n                  },\n                  {\n                    \"$ref\": \"#/$defs/RevenueAnalyticsPropertyFilter\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Properties\"\n        },\n        \"rollout_percentage\": {\n          \"anyOf\": [\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Rollout Percentage\"\n        },\n        \"sort_key\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Sort Key\"\n        },\n        \"users_affected\": {\n          \"anyOf\": [\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Users Affected\"\n        },\n        \"variant\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Variant\"\n        }\n      },\n      \"title\": \"FeatureFlagGroupType\",\n      \"type\": \"object\"\n    },\n    \"FeaturePropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"feature\",\n          \"default\": \"feature\",\n          \"description\": \"Event property with \\\"$feature/\\\" prepended\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"FeaturePropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"FlagPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"description\": \"The key should be the flag ID\",\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"const\": \"flag_evaluates_to\",\n          \"default\": \"flag_evaluates_to\",\n          \"description\": \"Only flag_evaluates_to operator is allowed for flag dependencies\",\n          \"title\": \"Operator\",\n          \"type\": \"string\"\n        },\n        \"type\": {\n          \"const\": \"flag\",\n          \"default\": \"flag\",\n          \"description\": \"Feature flag dependency\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"string\"\n            }\n          ],\n          \"description\": \"The value can be true, false, or a variant name\",\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"value\"\n      ],\n      \"title\": \"FlagPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"GroupPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"group_type_index\": {\n          \"anyOf\": [\n            {\n              \"type\": \"integer\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Group Type Index\"\n        },\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"group\",\n          \"default\": \"group\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"GroupPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"HogQLPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"type\": {\n          \"const\": \"hogql\",\n          \"default\": \"hogql\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\"\n      ],\n      \"title\": \"HogQLPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"Key\": {\n      \"enum\": [\n        \"tag_name\",\n        \"text\",\n        \"href\",\n        \"selector\"\n      ],\n      \"title\": \"Key\",\n      \"type\": \"string\"\n    },\n    \"LogEntryPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"log_entry\",\n          \"default\": \"log_entry\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"LogEntryPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"LogPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"$ref\": \"#/$defs/LogPropertyFilterType\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\",\n        \"type\"\n      ],\n      \"title\": \"LogPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"LogPropertyFilterType\": {\n      \"enum\": [\n        \"log\",\n        \"log_attribute\",\n        \"log_resource_attribute\"\n      ],\n      \"title\": \"LogPropertyFilterType\",\n      \"type\": \"string\"\n    },\n    \"MultivariateVariant\": {\n      \"description\": \"Schema for a multivariate flag variant.\",\n      \"properties\": {\n        \"key\": {\n          \"description\": \"Variant key (e.g., 'control', 'test', 'variant_a')\",\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"name\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"description\": \"Optional human-readable variant name\",\n          \"title\": \"Name\"\n        },\n        \"rollout_percentage\": {\n          \"description\": \"Percentage of users assigned to this variant (0-100)\",\n          \"maximum\": 100,\n          \"minimum\": 0,\n          \"title\": \"Rollout Percentage\",\n          \"type\": \"integer\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"rollout_percentage\"\n      ],\n      \"title\": \"MultivariateVariant\",\n      \"type\": \"object\"\n    },\n    \"PersonPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"person\",\n          \"default\": \"person\",\n          \"description\": \"Person properties\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"PersonPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"PropertyOperator\": {\n      \"enum\": [\n        \"exact\",\n        \"is_not\",\n        \"icontains\",\n        \"not_icontains\",\n        \"regex\",\n        \"not_regex\",\n        \"gt\",\n        \"gte\",\n        \"lt\",\n        \"lte\",\n        \"is_set\",\n        \"is_not_set\",\n        \"is_date_exact\",\n        \"is_date_before\",\n        \"is_date_after\",\n        \"between\",\n        \"not_between\",\n        \"min\",\n        \"max\",\n        \"in\",\n        \"not_in\",\n        \"is_cleaned_path_exact\",\n        \"flag_evaluates_to\",\n        \"semver_eq\",\n        \"semver_neq\",\n        \"semver_gt\",\n        \"semver_gte\",\n        \"semver_lt\",\n        \"semver_lte\",\n        \"semver_tilde\",\n        \"semver_caret\",\n        \"semver_wildcard\"\n      ],\n      \"title\": \"PropertyOperator\",\n      \"type\": \"string\"\n    },\n    \"RecordingPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"anyOf\": [\n            {\n              \"$ref\": \"#/$defs/DurationType\"\n            },\n            {\n              \"type\": \"string\"\n            }\n          ],\n          \"title\": \"Key\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"recording\",\n          \"default\": \"recording\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"RecordingPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"RevenueAnalyticsPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"revenue_analytics\",\n          \"default\": \"revenue_analytics\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"RevenueAnalyticsPropertyFilter\",\n      \"type\": \"object\"\n    },\n    \"SessionPropertyFilter\": {\n      \"additionalProperties\": false,\n      \"properties\": {\n        \"key\": {\n          \"title\": \"Key\",\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Label\"\n        },\n        \"operator\": {\n          \"$ref\": \"#/$defs/PropertyOperator\"\n        },\n        \"type\": {\n          \"const\": \"session\",\n          \"default\": \"session\",\n          \"title\": \"Type\",\n          \"type\": \"string\"\n        },\n        \"value\": {\n          \"anyOf\": [\n            {\n              \"items\": {\n                \"anyOf\": [\n                  {\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"type\": \"number\"\n                  },\n                  {\n                    \"type\": \"boolean\"\n                  }\n                ]\n              },\n              \"type\": \"array\"\n            },\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\": \"number\"\n            },\n            {\n              \"type\": \"boolean\"\n            },\n            {\n              \"type\": \"null\"\n            }\n          ],\n          \"default\": null,\n          \"title\": \"Value\"\n        }\n      },\n      \"required\": [\n        \"key\",\n        \"operator\"\n      ],\n      \"title\": \"SessionPropertyFilter\",\n      \"type\": \"object\"\n    }\n  },\n  \"description\": \"Structured schema for AI-powered feature flag creation using PostHog's native types.\",\n  \"properties\": {\n    \"key\": {\n      \"description\": \"Unique flag key in kebab-case (e.g., 'new-dashboard', 'dark-mode'). Must only contain letters, numbers, underscores, and hyphens. Pattern: ^[a-zA-Z0-9_-]+$\",\n      \"title\": \"Key\",\n      \"type\": \"string\"\n    },\n    \"name\": {\n      \"description\": \"Human-readable flag name\",\n      \"title\": \"Name\",\n      \"type\": \"string\"\n    },\n    \"description\": {\n      \"anyOf\": [\n        {\n          \"type\": \"string\"\n        },\n        {\n          \"type\": \"null\"\n        }\n      ],\n      \"default\": null,\n      \"description\": \"Optional description of what the flag controls\",\n      \"title\": \"Description\"\n    },\n    \"active\": {\n      \"default\": true,\n      \"description\": \"Whether the flag is active\",\n      \"title\": \"Active\",\n      \"type\": \"boolean\"\n    },\n    \"group_type\": {\n      \"anyOf\": [\n        {\n          \"type\": \"string\"\n        },\n        {\n          \"type\": \"null\"\n        }\n      ],\n      \"default\": null,\n      \"description\": \"Group type name for group-based targeting (e.g., 'organization', 'company')\",\n      \"title\": \"Group Type\"\n    },\n    \"groups\": {\n      \"description\": \"Feature flag groups containing properties and rollout percentage. Uses PostHog's native FeatureFlagGroupType schema.\",\n      \"items\": {\n        \"$ref\": \"#/$defs/FeatureFlagGroupType\"\n      },\n      \"title\": \"Groups\",\n      \"type\": \"array\"\n    },\n    \"tags\": {\n      \"description\": \"Tags for organizing and categorizing the flag\",\n      \"items\": {\n        \"type\": \"string\"\n      },\n      \"title\": \"Tags\",\n      \"type\": \"array\"\n    },\n    \"variants\": {\n      \"anyOf\": [\n        {\n          \"items\": {\n            \"$ref\": \"#/$defs/MultivariateVariant\"\n          },\n          \"type\": \"array\"\n        },\n        {\n          \"type\": \"null\"\n        }\n      ],\n      \"default\": null,\n      \"description\": \"Multivariate variants for A/B testing. If provided, creates a multivariate flag. Variant rollout percentages should sum to 100. Common example: [{'key': 'control', 'name': 'Control', 'rollout_percentage': 50}, {'key': 'test', 'name': 'Test', 'rollout_percentage': 50}]\",\n      \"title\": \"Variants\"\n    }\n  },\n  \"required\": [\n    \"key\",\n    \"name\"\n  ],\n  \"title\": \"FeatureFlagCreationSchema\",\n  \"type\": \"object\"\n}\n```\n\n</details>\n\n## Key files\n\n- `products/feature_flags/backend/max_tools.py` \u2014 Tool implementation and Pydantic schemas\n- `posthog/schema.py` \u2014 Shared `FeatureFlagGroupType` schema used by the groups field\n\n## Common patterns\n\n### Simple percentage rollout\n\n```json\n{\n  \"key\": \"dark-mode\",\n  \"name\": \"Dark Mode\",\n  \"groups\": [{\"properties\": [], \"rollout_percentage\": 50}]\n}\n```\n\n### Property-based targeting\n\n```json\n{\n  \"key\": \"enterprise-feature\",\n  \"name\": \"Enterprise Feature\",\n  \"group_type\": \"organization\",\n  \"groups\": [\n    {\n      \"properties\": [\n        {\"key\": \"plan\", \"value\": \"enterprise\", \"operator\": \"exact\", \"type\": \"group\", \"group_type_index\": 0}\n      ],\n      \"rollout_percentage\": null\n    }\n  ]\n}\n```\n\n### A/B test\n\n```json\n{\n  \"key\": \"checkout-test\",\n  \"name\": \"Checkout A/B Test\",\n  \"variants\": [\n    {\"key\": \"control\", \"name\": \"Control\", \"rollout_percentage\": 50},\n    {\"key\": \"new_flow\", \"name\": \"New Flow\", \"rollout_percentage\": 50}\n  ],\n  \"groups\": [{\"properties\": [], \"rollout_percentage\": null}]\n}\n```\n"
                },
                {
                    "path": "references/example.md",
                    "content": "# Example2940\n"
                }
            ],
            "source": "products/feature_flags/skills/feature-flag-creation"
        },
        {
            "name": "survey-sdk-audit",
            "description": "Audit PostHog survey SDK features and version requirements",
            "files": [
                {
                    "path": "SKILL.md",
                    "content": "---\nname: survey-sdk-audit\ndescription: Audit PostHog survey SDK features and version requirements\n---\n\n# Surveys SDK Feature Audit Skill\n\nUse this skill when auditing survey feature support across PostHog SDKs for `surveyVersionRequirements.ts`.\n\n**Feature to audit:** $ARGUMENTS\n\n## Setup Check (Run First)\n\nBefore starting, verify the SDK paths are accessible. Run `ls` on each path:\n\n- `$POSTHOG_JS_PATH`\n- `$POSTHOG_IOS_PATH`\n- `$POSTHOG_ANDROID_PATH`\n- `$POSTHOG_FLUTTER_PATH`\n\nIf any path is empty or doesn't exist, ask the user: \"I need the path to [SDK repo] on your machine. Where is it located?\"\n\nOnce you have all paths, ask the user if they'd like to save them for future sessions by adding to `.claude/settings.local.json`:\n\n```json\n{\n  \"env\": {\n    \"POSTHOG_JS_PATH\": \"/path/to/posthog-js\",\n    \"POSTHOG_IOS_PATH\": \"/path/to/posthog-ios\",\n    \"POSTHOG_ANDROID_PATH\": \"/path/to/posthog-android\",\n    \"POSTHOG_FLUTTER_PATH\": \"/path/to/posthog-flutter\"\n  },\n  \"permissions\": {\n    \"allow\": [\n      \"Read(/path/to/posthog-js/**)\",\n      \"Read(/path/to/posthog-ios/**)\",\n      \"Read(/path/to/posthog-android/**)\",\n      \"Read(/path/to/posthog-flutter/**)\",\n      \"Grep(/path/to/posthog-js/**)\",\n      \"Grep(/path/to/posthog-ios/**)\",\n      \"Grep(/path/to/posthog-android/**)\",\n      \"Grep(/path/to/posthog-flutter/**)\"\n    ]\n  }\n}\n```\n\n**Note:** The `Read` and `Grep` permissions grant Claude access to these external SDK repositories without prompting each time.\n\n## Using SDK Paths in Commands\n\n**IMPORTANT**: Environment variables like `$POSTHOG_JS_PATH` do NOT expand reliably in Bash tool commands.\n\nInstead of bash commands, prefer:\n\n- **Use the Read tool** to read files (works with permissions)\n- **Use the Grep tool** to search files (works with permissions)\n\nIf you must use bash, first expand the variable:\n\n```bash\necho $POSTHOG_JS_PATH\n```\n\nThen use the echoed path directly in subsequent commands.\n\n## Tracking Issue\n\nAll survey SDK feature parity work is tracked in:\n**https://github.com/PostHog/posthog/issues/45658**\n\nWhen creating new issues for missing features:\n\n1. Create the issue in the appropriate SDK repo (see labels below)\n2. Add the issue to the tracking issue's \"Tracked Issues\" section as a task list item:\n\n   ```markdown\n   - [ ] https://github.com/PostHog/repo/issues/123\n   ```\n\n   Note: GitHub automatically expands issue links to show titles, so no description is needed.\n\n3. Update the relevant feature table in the tracking issue if needed\n\nTo update the tracking issue body:\n\n**Step 1**: Fetch the current body to a temp file:\n\n```bash\ngh api repos/PostHog/posthog/issues/45658 --jq '.body' > /tmp/tracking_issue_body.md\n```\n\n**Step 2**: Use the Edit tool to modify `/tmp/tracking_issue_body.md`. This ensures the user can review the diff of your changes before proceeding.\n\n**Step 3**: After the user has approved the edits, push the update:\n\n```bash\ngh api repos/PostHog/posthog/issues/45658 -X PATCH -f body=\"$(cat /tmp/tracking_issue_body.md)\"\n```\n\n**Important**: Always use the Edit tool on the temp file rather than writing directly. This gives the user visibility into exactly what changes are being made to the tracking issue.\n\n## SDK Paths and Changelogs\n\n| SDK                  | Code Path                                | Changelog                                             |\n| -------------------- | ---------------------------------------- | ----------------------------------------------------- |\n| posthog-js (browser) | `$POSTHOG_JS_PATH/packages/browser`      | `$POSTHOG_JS_PATH/packages/browser/CHANGELOG.md`      |\n| posthog-react-native | `$POSTHOG_JS_PATH/packages/react-native` | `$POSTHOG_JS_PATH/packages/react-native/CHANGELOG.md` |\n| posthog-ios          | `$POSTHOG_IOS_PATH`                      | `$POSTHOG_IOS_PATH/CHANGELOG.md`                      |\n| posthog-android      | `$POSTHOG_ANDROID_PATH`                  | `$POSTHOG_ANDROID_PATH/CHANGELOG.md`                  |\n| posthog-flutter      | `$POSTHOG_FLUTTER_PATH`                  | `$POSTHOG_FLUTTER_PATH/CHANGELOG.md`                  |\n\n## Flutter Native Dependencies\n\nFlutter wraps native SDKs. Check dependency versions in:\n\n- iOS: `$POSTHOG_FLUTTER_PATH/ios/posthog_flutter.podspec` (look for `s.dependency 'PostHog'`)\n- Android: `$POSTHOG_FLUTTER_PATH/android/build.gradle` (look for `posthog-android` dependency)\n\n## Audit Process\n\n### Step 1: Understand the Feature\n\nLook at the `check` function in `surveyVersionRequirements.ts` to understand what field/condition triggers this feature:\n\n- `s.conditions?.deviceTypes` \u2192 search for \"deviceTypes\"\n- `s.appearance?.fontFamily` \u2192 search for \"fontFamily\"\n- `s.conditions?.urlMatchType` \u2192 search for \"urlMatchType\"\n\n### Step 2: Search Changelogs First\n\n```bash\n# Search changelog for the feature keyword\ngrep -n -i \"KEYWORD\" /path/to/CHANGELOG.md\n```\n\nIf found, read the surrounding lines to get the version number.\n\n### Step 3: Search Code If Not in Changelog\n\n```bash\n# Find commits that added the keyword (use -S for exact string match)\ncd /path/to/sdk && git log --oneline --all -S \"KEYWORD\" -- \"*.swift\" \"*.kt\" \"*.ts\" \"*.tsx\"\n\n# Then find the first version tag containing that commit\ngit tag --contains COMMIT_HASH | sort -V | head -3\n```\n\n### Step 4: For Flutter, Find When Native Dependency Was Bumped\n\n```bash\n# Find when Flutter started requiring iOS version X.Y.Z\ncd $POSTHOG_FLUTTER_PATH && git log --oneline -p -- \"ios/posthog_flutter.podspec\" | grep -B10 \"X.Y.Z\"\n\n# Get the Flutter version for that commit\ngit tag --contains COMMIT_HASH | sort -V | head -1\n```\n\n### Step 5: Verify Feature Actually Works (Not Just Types)\n\n**CRITICAL**: Having a field in a data model does NOT mean the feature is implemented. You must check the actual filtering/matching logic.\n\nKey files to check for survey filtering logic:\n\n- **posthog-js (browser)**: `$POSTHOG_JS_PATH/packages/browser/src/extensions/surveys/surveys-extension-utils.tsx` - utility functions like `canActivateRepeatedly`, `getSurveySeen`, `hasEvents`\n- **posthog-js (browser)**: `$POSTHOG_JS_PATH/packages/browser/src/extensions/surveys.tsx` - main survey logic\n- **posthog-react-native**: `$POSTHOG_JS_PATH/packages/react-native/src/surveys/getActiveMatchingSurveys.ts` - main filtering logic\n- **posthog-react-native**: `$POSTHOG_JS_PATH/packages/react-native/src/surveys/surveys-utils.ts` - utility functions like `canActivateRepeatedly`, `hasEvents`\n- **posthog-ios**: `$POSTHOG_IOS_PATH/PostHog/Surveys/PostHogSurveyIntegration.swift` \u2192 `getActiveMatchingSurveys()` method, `canActivateRepeatedly` computed property\n- **posthog-android**: `$POSTHOG_ANDROID_PATH/posthog-android/src/main/java/com/posthog/android/surveys/PostHogSurveysIntegration.kt` \u2192 `getActiveMatchingSurveys()` method, `canActivateRepeatedly()` function\n\n**Key utility functions to compare across SDKs:**\n\n- `canActivateRepeatedly` - determines if a survey can be shown again after being seen\n- `hasEvents` - checks if survey has event-based triggers\n- `getSurveySeen` - checks if user has already seen the survey\n\n**Example pitfall 1**: Both iOS and Android have `linkedFlagKey` in their Survey model, but neither implements `linkedFlagVariant` checking. They only call `isFeatureEnabled(key)` (boolean) instead of comparing `flags[key] === variant`.\n\n**Example pitfall 2**: The browser `canActivateRepeatedly` checks THREE conditions: (1) event repeatedActivation, (2) `schedule === 'always'`, (3) survey in progress. Mobile SDKs may only check condition (1), missing the `schedule` check entirely.\n\nWhat to look for:\n\n- Is the field parsed from JSON into the model? (necessary but not sufficient)\n- Is the field used in filtering logic like `getActiveMatchingSurveys()`?\n- Does the logic match the reference implementation behavior?\n- Test files don't count as implementation\n\n## Reference Implementation\n\n**posthog-js browser is the canonical implementation** - it has every feature and is the source of truth for how things are supposed to work.\n\nWhen auditing a feature:\n\n1. First check `$POSTHOG_JS_PATH/packages/browser/src/extensions/surveys.ts` to understand the complete, correct behavior\n2. Then compare mobile SDKs against posthog-react-native (`$POSTHOG_JS_PATH/packages/react-native/src/surveys/getActiveMatchingSurveys.ts`) which is the reference for mobile-specific implementations\n\n## Web-Only vs Cross-Platform Features\n\nSome features only make sense on web:\n\n- **URL targeting**: No concept of \"current URL\" in native apps \u2192 `issue: false` for all mobile\n- **CSS selector targeting**: No DOM in native apps \u2192 `issue: false` for all mobile\n- **Custom fonts via CSS**: May need native implementation or may not be applicable\n\n## Output Format\n\nFor each feature, produce:\n\n```typescript\n{\n    feature: 'Feature Name',\n    sdkVersions: {\n        'posthog-js': 'X.Y.Z',\n        'posthog-react-native': 'X.Y.Z',  // or omit if unsupported\n        'posthog-ios': 'X.Y.Z',\n        'posthog-android': 'X.Y.Z',\n        'posthog_flutter': 'X.Y.Z',  // add comment: first version to require native SDK >= X.Y\n    },\n    unsupportedSdks: [\n        { sdk: 'sdk-name', issue: 'https://github.com/PostHog/repo/issues/123' },  // needs implementation\n        { sdk: 'sdk-name', issue: false },  // not applicable (e.g., web-only feature)\n    ],\n    check: (s) => ...,\n}\n```\n\n## Creating GitHub Issues\n\n**IMPORTANT: Always search for existing issues BEFORE creating new ones.**\n\n```bash\n# Search in the SDK-specific repo\ngh issue list --repo PostHog/posthog-ios --search \"FEATURE_KEYWORD\" --state all --limit 20\ngh issue list --repo PostHog/posthog-android --search \"FEATURE_KEYWORD\" --state all --limit 20\ngh issue list --repo PostHog/posthog-flutter --search \"FEATURE_KEYWORD\" --state all --limit 20\n\n# Also search with broader terms\ngh issue list --repo PostHog/posthog-ios --search \"survey feature flag\" --state all --limit 20\n```\n\nAlways search issues in the main repo `PostHog/posthog` AND the SDK-specific repo(s) to ensure an issue does not already exist anywhere.\n\n### Labels by Repository\n\n| Repository              | Labels for Survey Features |\n| ----------------------- | -------------------------- |\n| PostHog/posthog-js      | `feature/surveys`          |\n| PostHog/posthog-ios     | `Survey`, `enhancement`    |\n| PostHog/posthog-android | `Survey`, `enhancement`    |\n| PostHog/posthog-flutter | `Survey`, `enhancement`    |\n\n### Issue Creation Command\n\n```bash\n# posthog-js (covers browser and react-native)\ngh issue create --repo PostHog/posthog-js --label \"feature/surveys\" --title \"...\" --body \"...\"\n\n# posthog-ios\ngh issue create --repo PostHog/posthog-ios --label \"Survey\" --label \"enhancement\" --title \"...\" --body \"...\"\n\n# posthog-android\ngh issue create --repo PostHog/posthog-android --label \"Survey\" --label \"enhancement\" --title \"...\" --body \"...\"\n\n# posthog-flutter\ngh issue create --repo PostHog/posthog-flutter --label \"Survey\" --label \"enhancement\" --title \"...\" --body \"...\"\n```\n\n### Issue Template\n\n```markdown\n## \ud83d\udea8 IMPORTANT\n\nThis issue is likely user-facing in the main PostHog app, see [`surveyVersionRequirements.ts`](https://github.com/PostHog/posthog/blob/master/frontend/src/scenes/surveys/surveyVersionRequirements.ts). If you delete or close this issue, be sure to update the version requirements list here.\n\n## Summary\n\nThe [SDK] SDK does not support [feature] for surveys.\n\n## Current State\n\n- [What exists, if anything - types, partial implementation, etc.]\n\n## Expected Behavior\n\n[What should happen when this feature is configured]\n\n## Reference Implementation\n\nSee posthog-js browser: `packages/browser/src/extensions/surveys.ts`\nFor mobile-specific patterns, see posthog-react-native: `packages/react-native/src/surveys/getActiveMatchingSurveys.ts`\n\n## Tracking\n\nThis is tracked in the survey SDK feature parity issue: https://github.com/PostHog/posthog/issues/45658\n\n_This issue was generated by Claude using the `/survey-sdk-audit` skill._\n```\n\n## Completion Checklist\n\nBefore finishing the audit, verify all steps are complete:\n\n- [ ] **Understand the feature** - Read the check function in `surveyVersionRequirements.ts`\n- [ ] **Check browser SDK** - Find version in changelog (this is the reference implementation)\n- [ ] **Check react-native SDK** - Find version in changelog\n- [ ] **Check iOS SDK** - Verify if feature is actually implemented (not just types)\n- [ ] **Check Android SDK** - Verify if feature is actually implemented (not just types)\n- [ ] **Check Flutter SDK** - Check native dependency versions\n- [ ] **Search for existing issues** - Before creating new ones\n- [ ] **Create GitHub issues** - For any unsupported SDKs (with proper labels)\n- [ ] **Update surveyVersionRequirements.ts** - Fix versions and add issue links to unsupportedSdks\n- [ ] **Update tracking issue** - Add new issues to https://github.com/PostHog/posthog/issues/45658\n\n## Common Pitfalls\n\n1. **Don't guess versions** - always verify with changelog or git history\n2. **Types \u2260 Implementation** - having a field in a data class doesn't mean filtering logic exists\n3. **Model field \u2260 Feature support** - the field may be parsed but never used in decision-making (e.g., `linkedFlagKey` exists but `linkedFlagVariant` check is missing)\n4. **Test code \u2260 Production code** - functions only in test files aren't shipped\n5. **Flutter inherits from native** - its \"support\" depends on iOS/Android SDK versions it requires\n6. **Always search for existing issues first** - before creating new GitHub issues\n7. **Compare utility function implementations** - functions like `canActivateRepeatedly` may have different logic across SDKs; browser is the source of truth\n\n## Post-Audit: Skill Improvement\n\nAfter completing an audit, consider whether any learnings should be added to this skill file:\n\n1. **New pitfalls discovered** - Add to Common Pitfalls section\n2. **New key files identified** - Add to the file paths in Step 5\n3. **New utility functions to compare** - Add to the \"Key utility functions\" list\n4. **Pattern changes** - If SDK implementations have changed structure, update paths\n\nIf you find improvements, propose them to the user:\n\n```plaintext\nI found some learnings during this audit that could improve the skill:\n- [describe the improvement]\n\nWould you like me to update the skill file?\n```\n"
                }
            ],
            "source": "products/surveys/skills/survey-sdk-audit"
        }
    ]
}
