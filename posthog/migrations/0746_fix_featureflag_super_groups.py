# Generated by Django 4.2.18 on 2025-05-28 22:09

from django.db import migrations


class Migration(migrations.Migration):
    dependencies = [
        ("posthog", "0745_oauthaccesstoken_oauthapplication_oauthrefreshtoken_and_more"),
    ]

    operations = [
        migrations.RunSQL(
            """
            UPDATE posthog_featureflag
            SET
                filters = jsonb_set(
                    filters,
                    '{super_groups,0,properties,0,key}',
                    to_jsonb('$feature_enrollment/' || key)
                )
            WHERE
                active = true
                AND filters->'super_groups'->0->'properties'->0->>'key' IS NOT NULL
                AND filters->'super_groups'->0->'properties'->0->>'key' LIKE '$feature_enrollment/%'
                AND filters->'super_groups'->0->'properties'->0->>'key' != '$feature_enrollment/' || key;
            """,
            reverse_sql=migrations.RunSQL.noop,
            elidable=True,
        ),
    ]
