# Generated by Django 4.2.27 on 2026-01-16 14:39

import django.utils.timezone
import django.db.models.deletion
from django.db import migrations, models

import posthog.models.utils


class Migration(migrations.Migration):
    dependencies = [
        ("posthog", "1005_objectmediapreview_and_more"),
    ]

    operations = [
        migrations.AddField(
            model_name="team",
            name="feedback_recording_opt_in",
            field=models.BooleanField(blank=True, null=True),
        ),
        migrations.CreateModel(
            name="FeedbackAudio",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=posthog.models.utils.uuid7, editable=False, primary_key=True, serialize=False
                    ),
                ),
                (
                    "feedback_id",
                    models.CharField(
                        help_text="Identifier linking this audio to a feedback submission", max_length=255
                    ),
                ),
                ("audio_size", models.PositiveIntegerField(help_text="Size of audio file in bytes")),
                ("content_type", models.CharField(help_text="MIME type of the audio file", max_length=50)),
                (
                    "media_location",
                    models.TextField(blank=True, help_text="Object storage location of the audio file", null=True),
                ),
                ("created_at", models.DateTimeField(default=django.utils.timezone.now)),
                (
                    "team",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE, related_name="feedback_audio", to="posthog.team"
                    ),
                ),
            ],
            options={
                "indexes": [
                    models.Index(fields=["team", "created_at"], name="posthog_fee_team_id_0b27aa_idx"),
                    models.Index(fields=["feedback_id"], name="posthog_fee_feedbac_b6d93f_idx"),
                ],
            },
        ),
        migrations.AddConstraint(
            model_name="feedbackaudio",
            constraint=models.UniqueConstraint(fields=("team", "feedback_id"), name="unique_feedback_audio_per_team"),
        ),
    ]
