# Generated by Django 3.0.5 on 2020-04-09 10:55

from django.db import migrations

def update_filter_types(apps, schema_editor):
    DashboardItem = apps.get_model('posthog', 'DashboardItem')
    for item in DashboardItem.objects.filter(filters__actions__isnull=False):
        item.filters['actions'] = [{'id': action['id'], 'type': 'actions' if isinstance(action['id'], int) else 'events'} for action in item.filters['actions']]
        item.save()

def reverse_filter_types(apps, schema_editor):
    DashboardItem = apps.get_model('posthog', 'DashboardItem')
    for item in DashboardItem.objects.filter(filters__actions__isnull=False):
        item.filters['actions'] = [{'id': action['id']} if isinstance(action['id'], int) else {'id': action['id'], 'type': 'events'} for action in item.filters['actions']]
        item.save()

class Migration(migrations.Migration):

    dependencies = [
        ('posthog', '0041_merge_20200407_1805'),
    ]

    operations = [
        migrations.RunPython(update_filter_types, reverse_filter_types)
    ]
