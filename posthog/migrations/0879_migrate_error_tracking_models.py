# Generated by Django 4.2.22 on 2025-10-10 13:52

from django.db import migrations


def update_content_type(apps, schema_editor):
    ContentType = apps.get_model("contenttypes", "ContentType")
    for model in [
        "errortrackingassignmentrule",
        "errortrackingexternalreference",
        "errortrackinggroup",
        "errortrackinggroupingrule",
        "errortrackingissue",
        "errortrackingissueassignment",
        "errortrackingissuefingerprint",
        "errortrackingissuefingerprintv2",
        "errortrackingrelease",
        "errortrackingstackframe",
        "errortrackingsuppressionrule",
        "errortrackingsymbolset",
    ]:
        try:
            ct = ContentType.objects.get(app_label="posthog", model=model)
            ct.app_label = "error_tracking"
            ct.save()
        except ContentType.DoesNotExist:
            pass


def reverse_content_type(apps, schema_editor):
    ContentType = apps.get_model("contenttypes", "ContentType")
    for model in [
        "errortrackingassignmentrule",
        "errortrackingexternalreference",
        "errortrackinggroup",
        "errortrackinggroupingrule",
        "errortrackingissue",
        "errortrackingissueassignment",
        "errortrackingissuefingerprint",
        "errortrackingissuefingerprintv2",
        "errortrackingrelease",
        "errortrackingstackframe",
        "errortrackingsuppressionrule",
        "errortrackingsymbolset",
    ]:
        try:
            ct = ContentType.objects.get(app_label="error_tracking", model=model)
            ct.app_label = "posthog"
            ct.save()
        except ContentType.DoesNotExist:
            pass


class Migration(migrations.Migration):
    dependencies = [
        ("posthog", "0878_alter_externaldatasource_source_type"),
    ]

    operations = [
        migrations.SeparateDatabaseAndState(
            database_operations=[
                migrations.RunPython(update_content_type, reverse_content_type),
            ],
            state_operations=[
                migrations.RemoveField(
                    model_name="errortrackingexternalreference",
                    name="integration",
                ),
                migrations.RemoveField(
                    model_name="errortrackingexternalreference",
                    name="issue",
                ),
                migrations.RemoveField(
                    model_name="errortrackinggroup",
                    name="assignee",
                ),
                migrations.RemoveField(
                    model_name="errortrackinggroup",
                    name="team",
                ),
                migrations.RemoveField(
                    model_name="errortrackinggroupingrule",
                    name="role",
                ),
                migrations.RemoveField(
                    model_name="errortrackinggroupingrule",
                    name="team",
                ),
                migrations.RemoveField(
                    model_name="errortrackinggroupingrule",
                    name="user",
                ),
                migrations.RemoveField(
                    model_name="errortrackinggroupingrule",
                    name="user_group",
                ),
                migrations.RemoveField(
                    model_name="errortrackingissue",
                    name="team",
                ),
                migrations.RemoveField(
                    model_name="errortrackingissueassignment",
                    name="issue",
                ),
                migrations.RemoveField(
                    model_name="errortrackingissueassignment",
                    name="role",
                ),
                migrations.RemoveField(
                    model_name="errortrackingissueassignment",
                    name="user",
                ),
                migrations.RemoveField(
                    model_name="errortrackingissueassignment",
                    name="user_group",
                ),
                migrations.RemoveField(
                    model_name="errortrackingissuefingerprint",
                    name="issue",
                ),
                migrations.RemoveField(
                    model_name="errortrackingissuefingerprint",
                    name="team",
                ),
                migrations.RemoveField(
                    model_name="errortrackingissuefingerprintv2",
                    name="issue",
                ),
                migrations.RemoveField(
                    model_name="errortrackingissuefingerprintv2",
                    name="team",
                ),
                migrations.RemoveField(
                    model_name="errortrackingrelease",
                    name="team",
                ),
                migrations.RemoveField(
                    model_name="errortrackingstackframe",
                    name="symbol_set",
                ),
                migrations.RemoveField(
                    model_name="errortrackingstackframe",
                    name="team",
                ),
                migrations.RemoveField(
                    model_name="errortrackingsuppressionrule",
                    name="team",
                ),
                migrations.RemoveField(
                    model_name="errortrackingsymbolset",
                    name="release",
                ),
                migrations.RemoveField(
                    model_name="errortrackingsymbolset",
                    name="team",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingAssignmentRule",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingExternalReference",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingGroup",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingGroupingRule",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingIssue",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingIssueAssignment",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingIssueFingerprint",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingIssueFingerprintV2",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingRelease",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingStackFrame",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingSuppressionRule",
                ),
                migrations.DeleteModel(
                    name="ErrorTrackingSymbolSet",
                ),
            ],
        ),
    ]
