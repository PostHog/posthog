# Generated by Django 4.2.28 on 2026-02-18 08:16

import django.contrib.postgres.operations
from django.db import migrations, models


class Migration(migrations.Migration):
    atomic = False

    replaces = [
        ("posthog", "0681_file_system_depth"),
        ("posthog", "0682_datawarehousesavedquery_latest_error"),
        ("posthog", "0683_externaldataschema_sync_time_of_day"),
        ("posthog", "0684_action_embedding_last_synced_at_and_more"),
        ("posthog", "0685_add_playlist_counted_date"),
        ("posthog", "0686_alter_errortrackingissue_status"),
        ("posthog", "0687_remove_taxonomy_team_only_constraints"),
    ]

    dependencies = [
        ("posthog", "0680_alter_integration_kind"),
    ]

    operations = [
        migrations.AddField(
            model_name="filesystem",
            name="depth",
            field=models.IntegerField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name="datawarehousesavedquery",
            name="latest_error",
            field=models.TextField(blank=True, default=None, null=True),
        ),
        migrations.AddField(
            model_name="externaldataschema",
            name="sync_time_of_day",
            field=models.TimeField(blank=True, help_text="Time of day to run the sync (UTC)", null=True),
        ),
        migrations.AddField(
            model_name="action",
            name="embedding_last_synced_at",
            field=models.DateTimeField(
                blank=True, help_text="The last time the action was synced to the vector database", null=True
            ),
        ),
        migrations.AddField(
            model_name="action",
            name="last_summarized_at",
            field=models.DateTimeField(
                blank=True, help_text="The last time the action was summarized by AI", null=True
            ),
        ),
        migrations.AddField(
            model_name="action",
            name="summary",
            field=models.TextField(blank=True, help_text="A summary of the action, generated by AI", null=True),
        ),
        migrations.AddField(
            model_name="sessionrecordingplaylist",
            name="last_counted_at",
            field=models.DateTimeField(blank=True, null=True),
        ),
        django.contrib.postgres.operations.AddIndexConcurrently(
            model_name="sessionrecordingplaylist",
            index=models.Index(fields=["deleted", "last_counted_at"], name="deleted_n_last_count_idx"),
        ),
        django.contrib.postgres.operations.AddIndexConcurrently(
            model_name="sessionrecordingplaylist",
            index=models.Index(fields=["deleted", "-last_modified_at"], name="deleted_n_last_mod_desc_idx"),
        ),
        migrations.AlterField(
            model_name="errortrackingissue",
            name="status",
            field=models.TextField(
                choices=[
                    ("archived", "Archived"),
                    ("active", "Active"),
                    ("resolved", "Resolved"),
                    ("pending_release", "Pending release"),
                    ("suppressed", "Suppressed"),
                ],
                default="active",
            ),
        ),
        migrations.RemoveConstraint(
            model_name="eventproperty",
            name="posthog_event_property_unique_team_event_property",
        ),
        migrations.RemoveConstraint(
            model_name="propertydefinition",
            name="posthog_propertydefinition_uniq",
        ),
        migrations.SeparateDatabaseAndState(
            database_operations=[
                migrations.RunSQL(
                    sql="ALTER TABLE posthog_eventdefinition DROP CONSTRAINT posthog_eventdefinition_team_id_name_80fa0b87_uniq",
                    reverse_sql="ALTER TABLE posthog_eventdefinition ADD CONSTRAINT posthog_eventdefinition_team_id_name_80fa0b87_uniq UNIQUE (team_id, name)",
                ),
            ],
            state_operations=[
                migrations.AlterUniqueTogether(
                    name="eventdefinition",
                    unique_together=set(),
                ),
            ],
        ),
    ]
