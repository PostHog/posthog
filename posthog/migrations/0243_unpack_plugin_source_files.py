# Generated by Django 3.2.13 on 2022-06-15 15:28
# Follow-up to 0233_plugin_source_file

from django.db import migrations


def forwards_func(apps, schema_editor):
    Plugin = apps.get_model("posthog", "Plugin")
    PluginSourceFile = apps.get_model("posthog", "PluginSourceFile")
    for plugin in Plugin.objects.exclude(plugin_type="source").exclude(plugin_type="local"):
        PluginSourceFile.objects.create_from_plugin_archive(plugin)


def reverse_func(apps, schema_editor):
    PluginSourceFile = apps.get_model("posthog", "PluginSourceFile")
    PluginSourceFile.objects.filter(plugin__plugin_type__in=["source", "local"]).delete()


class Migration(migrations.Migration):

    dependencies = [
        ("posthog", "0242_team_live_events_columns"),
    ]

    operations = [
        migrations.RunPython(forwards_func, reverse_func),
    ]
