# Generated by Django 4.2.15 on 2024-11-27
from django.db import migrations


class Migration(migrations.Migration):
    dependencies = [
        ("posthog", "0921_teammarketinganalyticsconfig__campaign_field_preferences_and_more"),
    ]

    operations = [
        # Drop foreign key constraints for all tables that are now in the persons database
        # These tables are managed separately and don't need FK constraints to posthog_team
        # posthog_persondistinctid
        migrations.RunSQL(
            sql="""
                ALTER TABLE posthog_persondistinctid
                DROP CONSTRAINT IF EXISTS "posthog_persondistinctid_team_id_46330ec9_fk_posthog_team_id";
            """,
            reverse_sql="""
                ALTER TABLE posthog_persondistinctid
                ADD CONSTRAINT "posthog_persondistinctid_team_id_46330ec9_fk_posthog_team_id"
                FOREIGN KEY (team_id)
                REFERENCES posthog_team(id)
                DEFERRABLE INITIALLY DEFERRED;
            """,
        ),
        # posthog_personlessdistinctid
        migrations.RunSQL(
            sql="""
                ALTER TABLE posthog_personlessdistinctid
                DROP CONSTRAINT IF EXISTS "posthog_personlessdi_team_id_99211fb1_fk_posthog_t";
            """,
            reverse_sql="""
                ALTER TABLE posthog_personlessdistinctid
                ADD CONSTRAINT "posthog_personlessdi_team_id_99211fb1_fk_posthog_t"
                FOREIGN KEY (team_id)
                REFERENCES posthog_team(id)
                DEFERRABLE INITIALLY DEFERRED;
            """,
        ),
        # posthog_personoverride
        migrations.RunSQL(
            sql="""
                ALTER TABLE posthog_personoverride
                DROP CONSTRAINT IF EXISTS "posthog_personoverride_team_id_92291e67_fk_posthog_team_id";
            """,
            reverse_sql="""
                ALTER TABLE posthog_personoverride
                ADD CONSTRAINT "posthog_personoverride_team_id_92291e67_fk_posthog_team_id"
                FOREIGN KEY (team_id)
                REFERENCES posthog_team(id)
                DEFERRABLE INITIALLY DEFERRED;
            """,
        ),
        # posthog_featureflaghashkeyoverride
        migrations.RunSQL(
            sql="""
                ALTER TABLE posthog_featureflaghashkeyoverride
                DROP CONSTRAINT IF EXISTS "posthog_featureflagh_team_id_b626eed2_fk_posthog_t";
            """,
            reverse_sql="""
                ALTER TABLE posthog_featureflaghashkeyoverride
                ADD CONSTRAINT "posthog_featureflagh_team_id_b626eed2_fk_posthog_t"
                FOREIGN KEY (team_id)
                REFERENCES posthog_team(id)
                DEFERRABLE INITIALLY DEFERRED;
            """,
        ),
        # posthog_grouptypemapping
        migrations.RunSQL(
            sql="""
                ALTER TABLE posthog_grouptypemapping
                DROP CONSTRAINT IF EXISTS "posthog_grouptypemapping_team_id_5fb54d04_fk_posthog_team_id";
            """,
            reverse_sql="""
                ALTER TABLE posthog_grouptypemapping
                ADD CONSTRAINT "posthog_grouptypemapping_team_id_5fb54d04_fk_posthog_team_id"
                FOREIGN KEY (team_id)
                REFERENCES posthog_team(id)
                DEFERRABLE INITIALLY DEFERRED;
            """,
        ),
    ]
