# Generated by Django 4.2.22 on 2025-10-15 12:15

from django.db import migrations


def update_content_type(apps, schema_editor):
    ContentType = apps.get_model("contenttypes", "ContentType")
    for model in ["notebook", "resourcenotebook"]:
        try:
            ct = ContentType.objects.get(app_label="posthog", model=model)
            ct.app_label = "notebooks"
            ct.save()
        except ContentType.DoesNotExist:
            pass


def reverse_content_type(apps, schema_editor):
    ContentType = apps.get_model("contenttypes", "ContentType")
    for model in ["notebook", "resourcenotebook"]:
        try:
            ct = ContentType.objects.get(app_label="notebooks", model=model)
            ct.app_label = "posthog"
            ct.save()
        except ContentType.DoesNotExist:
            pass


class Migration(migrations.Migration):
    dependencies = [("posthog", "0884_experimenttimeseriesrecalculation_and_more")]

    operations = [
        migrations.SeparateDatabaseAndState(
            database_operations=[
                migrations.RunPython(update_content_type, reverse_content_type),
            ],
            state_operations=[
                migrations.AlterUniqueTogether(
                    name="resourcenotebook",
                    unique_together=None,
                ),
                migrations.RemoveField(
                    model_name="resourcenotebook",
                    name="notebook",
                ),
                migrations.DeleteModel(
                    name="Notebook",
                ),
                migrations.DeleteModel(
                    name="ResourceNotebook",
                ),
            ],
        ),
    ]
