# Generated by Django 4.2.28 on 2026-02-13 16:19

from django.db import migrations


def populate_dags(apps, _):
    DAG = apps.get_model("data_modeling", "DAG")
    Node = apps.get_model("data_modeling", "Node")
    distinct_dags = Node.objects.values_list("team_id", "dag_id").distinct()
    dags_to_create = []
    for team_id, dag_id in distinct_dags:
        dags_to_create.append(DAG(team_id=team_id, name=dag_id))
    DAG.objects.bulk_create(dags_to_create, ignore_conflicts=True)


class Migration(migrations.Migration):
    dependencies = [
        ("data_modeling", "0007_dag_dag_name_unique_within_team"),
    ]

    operations = [
        migrations.RunPython(populate_dags, migrations.RunPython.noop),
    ]
