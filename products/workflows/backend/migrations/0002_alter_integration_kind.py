# Generated by Django 4.2.26 on 2025-01-08 00:00

from django.db import migrations, models
from django.db.migrations.operations.base import Operation


class AlterPosthogIntegrationKindField(Operation):
    """Custom operation to alter the Integration model's kind field in the posthog app."""

    reduces_to_sql = False
    reversible = True

    def __init__(self):
        self.model_name = "integration"
        self.name = "kind"
        self.field = models.CharField(
            choices=[
                ("slack", "Slack"),
                ("salesforce", "Salesforce"),
                ("hubspot", "Hubspot"),
                ("google-pubsub", "Google Pubsub"),
                ("google-cloud-storage", "Google Cloud Storage"),
                ("google-ads", "Google Ads"),
                ("google-sheets", "Google Sheets"),
                ("snapchat", "Snapchat"),
                ("linkedin-ads", "Linkedin Ads"),
                ("reddit-ads", "Reddit Ads"),
                ("tiktok-ads", "Tiktok Ads"),
                ("bing-ads", "Bing Ads"),
                ("intercom", "Intercom"),
                ("email", "Email"),
                ("linear", "Linear"),
                ("github", "Github"),
                ("gitlab", "Gitlab"),
                ("meta-ads", "Meta Ads"),
                ("twilio", "Twilio"),
                ("clickup", "Clickup"),
                ("vercel", "Vercel"),
                ("databricks", "Databricks"),
                ("azure-blob", "Azure Blob"),
                ("firebase", "Firebase"),
            ],
            max_length=20,
        )

    def state_forwards(self, app_label, state):
        # Alter the field in the posthog app, not the workflows app
        state.alter_field(
            "posthog",
            self.model_name,
            self.name,
            self.field,
            preserve_default=True,
        )

    def database_forwards(self, app_label, schema_editor, from_state, to_state):
        # No database changes needed - choices are Python-level validation only
        pass

    def database_backwards(self, app_label, schema_editor, from_state, to_state):
        # No database changes needed
        pass

    def describe(self):
        return f"Alter field {self.name} on {self.model_name} (posthog app)"


class Migration(migrations.Migration):
    dependencies = [
        ("workflows", "0001_hogflowbatchjob"),
        ("posthog", "0970_add_session_recording_encryption"),
    ]

    operations = [
        migrations.SeparateDatabaseAndState(
            database_operations=[],
            state_operations=[
                AlterPosthogIntegrationKindField(),
            ],
        ),
    ]
