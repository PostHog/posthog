---
name: feature-flag-creation
description: Guide for creating feature flags via the PostHog AI agent tool, including the schema reference for FeatureFlagCreationSchema.
---

# Feature flag creation skill

This skill provides context for working with the AI-powered feature flag creation tool in PostHog.

## FeatureFlagCreationSchema

The `CreateFeatureFlagTool` accepts natural language instructions and uses a taxonomy agent to produce a structured `FeatureFlagCreationSchema`. The schema fields are:

{{ pydantic_fields("products.feature_flags.backend.max_tools.FeatureFlagCreationSchema") }}

### Multivariate variants

When the schema includes `variants`, each variant follows the `MultivariateVariant` schema:

{{ pydantic_fields("products.feature_flags.backend.max_tools.MultivariateVariant") }}

### Full JSON Schema

<details>
<summary>Expand FeatureFlagCreationSchema JSON Schema</summary>

```json
{{ pydantic_schema("products.feature_flags.backend.max_tools.FeatureFlagCreationSchema") }}
```

</details>

## Key files

- `products/feature_flags/backend/max_tools.py` — Tool implementation and Pydantic schemas
- `posthog/schema.py` — Shared `FeatureFlagGroupType` schema used by the groups field

## Common patterns

### Simple percentage rollout

```json
{
  "key": "dark-mode",
  "name": "Dark Mode",
  "groups": [{"properties": [], "rollout_percentage": 50}]
}
```

### Property-based targeting

```json
{
  "key": "enterprise-feature",
  "name": "Enterprise Feature",
  "group_type": "organization",
  "groups": [
    {
      "properties": [
        {"key": "plan", "value": "enterprise", "operator": "exact", "type": "group", "group_type_index": 0}
      ],
      "rollout_percentage": null
    }
  ]
}
```

### A/B test

```json
{
  "key": "checkout-test",
  "name": "Checkout A/B Test",
  "variants": [
    {"key": "control", "name": "Control", "rollout_percentage": 50},
    {"key": "new_flow", "name": "New Flow", "rollout_percentage": 50}
  ],
  "groups": [{"properties": [], "rollout_percentage": null}]
}
```
