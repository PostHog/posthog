# Generated by Django 4.2.26 on 2025-01-16 00:04

from django.db import migrations


class Migration(migrations.Migration):
    """
    Create unique index concurrently (non-blocking).
    This prepares for the constraint to be added in the next migration.
    """

    atomic = False  # Required for CREATE INDEX CONCURRENTLY

    dependencies = [
        ("conversations", "0005_ticket_number_not_null"),
    ]

    operations = [
        migrations.RunSQL(
            sql="""
                CREATE UNIQUE INDEX CONCURRENTLY IF NOT EXISTS "unique_ticket_number_per_team"
                ON "posthog_conversations_ticket" ("team_id", "ticket_number");
            """,
            reverse_sql='DROP INDEX CONCURRENTLY IF EXISTS "unique_ticket_number_per_team";',
        ),
    ]
