# Generated by Django 4.2.26 on 2025-01-16 00:03

from django.db import migrations, models


class Migration(migrations.Migration):
    """
    Make ticket_number NOT NULL after backfill.
    Uses SeparateDatabaseAndState to avoid table lock from AlterField.
    """

    dependencies = [
        ("conversations", "0004_backfill_ticket_numbers"),
    ]

    operations = [
        migrations.SeparateDatabaseAndState(
            state_operations=[
                migrations.AlterField(
                    model_name="ticket",
                    name="ticket_number",
                    field=models.PositiveIntegerField(),
                ),
            ],
            database_operations=[
                migrations.RunSQL(
                    sql='ALTER TABLE "posthog_conversations_ticket" ALTER COLUMN "ticket_number" SET NOT NULL;',
                    reverse_sql='ALTER TABLE "posthog_conversations_ticket" ALTER COLUMN "ticket_number" DROP NOT NULL;',
                ),
            ],
        ),
    ]
